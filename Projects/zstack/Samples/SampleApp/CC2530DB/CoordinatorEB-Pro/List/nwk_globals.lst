###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.20.2.41139 for 8051             11/Jan/2016  16:35:12 #
# Copyright 2004-2013 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#                                                                             #
#    Source file        =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Comp #
#                          onents\stack\nwk\nwk_globals.c                     #
#    Command line       =  -f C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\P #
#                          rojects\zstack\Samples\SampleApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ           #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f     #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\To #
#                          ols\CC2530DB\f8wConfig.cfg (-DSECURE=0             #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=TRUE      #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Comp #
#                          onents\stack\nwk\nwk_globals.c -D ZIGBEEPRO -D     #
#                          ZTOOL_P1 -D xMT_TASK -D xMT_SYS_FUNC -D            #
#                          xMT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -lC            #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\Coordinator #
#                          EB-Pro\List\ -lA C:\Users\ArnoldWorkStation\Deskto #
#                          p\ZigbeeTest\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\CoordinatorEB-Pro\List\ --diag_suppress      #
#                          Pe001,Pa010 -o C:\Users\ArnoldWorkStation\Desktop\ #
#                          ZigbeeTest\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\CoordinatorEB-Pro\Obj\ -e --no_cse             #
#                          --no_unroll --no_inline --no_code_motion           #
#                          --no_tbaa --debug --core=plain --dptr=16,1         #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\P #
#                          rojects\zstack\Samples\SampleApp\CC2530DB\ -I      #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\SOURCE\  #
#                          -I C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\P #
#                          rojects\zstack\Samples\SampleApp\CC2530DB\..\..\.. #
#                          \ZMAIN\TI2530DB\ -I C:\Users\ArnoldWorkStation\Des #
#                          ktop\ZigbeeTest\Projects\zstack\Samples\SampleApp\ #
#                          CC2530DB\..\..\..\..\..\COMPONENTS\MT\ -I          #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\HAL\INCLUDE\ -I                     #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\HAL\TARGET\CC2530EB\ -I             #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\OSAL\MCU\CCSOC\ -I                  #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\OSAL\INCLUDE\ -I                    #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\AF\ -I                        #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\NWK\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SEC\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SAPI\ -I                      #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SYS\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\ZDO\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\ZMAC\F8W\ -I                        #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\ZMAC\ -I C:\Users\ArnoldWorkStation #
#                          \Desktop\ZigbeeTest\Projects\zstack\Samples\Sample #
#                          App\CC2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SA #
#                          DDR\ -I C:\Users\ArnoldWorkStation\Desktop\ZigbeeT #
#                          est\Projects\zstack\Samples\SampleApp\CC2530DB\..\ #
#                          ..\..\..\..\COMPONENTS\SERVICES\SDATA\ -I          #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\INCLUDE\ -I                     #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\HIGH_LEVEL\ -I                  #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I             #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\    #
#                          -On --require_prototypes                           #
#    List file          =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\Coordinator #
#                          EB-Pro\List\nwk_globals.lst                        #
#    Object file        =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\Coordinator #
#                          EB-Pro\Obj\nwk_globals.r51                         #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Components\stack\nwk\nwk_globals.c
      1          /**************************************************************************************************
      2            Filename:       nwk_globals.c
      3            Revised:        $Date: 2010-01-11 09:24:44 -0800 (Mon, 11 Jan 2010) $
      4            Revision:       $Revision: 21474 $
      5          
      6            Description:    User definable Network Parameters.
      7          
      8          
      9            Copyright 2004-2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com. 
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41           * INCLUDES
     42           */
     43          #include "ZComdef.h"
     44          #include "OSAL.h"
     45          #include "AddrMgr.h"
     46          #include "AssocList.h"
     47          #include "BindingTable.h"
     48          #include "nwk_util.h"
     49          #include "nwk_globals.h"
     50          #include "APS.h"
     51          #include "ssp.h"
     52          #include "rtg.h"
     53          #include "ZDConfig.h"
     54          #include "ZGlobals.h"
     55          
     56          #if defined ( LCD_SUPPORTED )
     57            #include "OnBoard.h"
     58          #endif
     59          
     60          /* HAL */
     61          #include "hal_lcd.h"
     62          
     63          /*********************************************************************
     64           * MACROS
     65           */
     66          
     67          /*********************************************************************
     68           * CONSTANTS
     69           */
     70          
     71          // Maximums for the data buffer queue
     72          #define NWK_MAX_DATABUFS_WAITING    8     // Waiting to be sent to MAC
     73          #define NWK_MAX_DATABUFS_SCHEDULED  5     // Timed messages to be sent
     74          #define NWK_MAX_DATABUFS_CONFIRMED  5     // Held after MAC confirms
     75          #define NWK_MAX_DATABUFS_TOTAL      12    // Total number of buffers
     76          
     77          // 1-255 (0 -> 256) X RTG_TIMER_INTERVAL
     78          // A known shortcoming is that when a message is enqueued as "hold" for a
     79          // sleeping device, the timer tick may have counted down to 1, so that msg
     80          // will not be held as long as expected. If NWK_INDIRECT_MSG_TIMEOUT is set to 1
     81          // the hold time will vary randomly from 0 - CNT_RTG_TIMER ticks.
     82          // So the hold time will vary within this interval:
     83          // { (NWK_INDIRECT_MSG_TIMEOUT-1)*CNT_RTG_TIMER,
     84          //                                    NWK_INDIRECT_MSG_TIMEOUT*CNT_RTG_TIMER }
     85          #define NWK_INDIRECT_CNT_RTG_TMR    1
     86          // To hold msg for sleeping end devices for 30 secs:
     87          // #define CNT_RTG_TIMER            1
     88          // #define NWK_INDIRECT_MSG_TIMEOUT 30
     89          // To hold msg for sleeping end devices for 30 mins:
     90          // #define CNT_RTG_TIMER            60
     91          // #define NWK_INDIRECT_MSG_TIMEOUT 30
     92          // To hold msg for sleeping end devices for 30 days:
     93          // #define CNT_RTG_TIMER            60
     94          // #define NWK_INDIRECT_MSG_TIMEOUT (30 * 24 * 60)
     95          // Maximum msgs to hold per associated device.
     96          #define NWK_INDIRECT_MSG_MAX_PER    3
     97          // Maximum total msgs to hold for all associated devices.
     98          #define NWK_INDIRECT_MSG_MAX_ALL    \
     99                                      (NWK_MAX_DATABUFS_TOTAL - NWK_INDIRECT_MSG_MAX_PER)
    100          
    101          /*********************************************************************
    102           * TYPEDEFS
    103           */
    104          
    105          /*********************************************************************
    106           * NWK GLOBAL VARIABLES
    107           */
    108          
    109          // Variables for MAX list size

   \                                 In  segment CODE_C, align 1
    110          CONST uint16 gNWK_MAX_DEVICE_LIST = NWK_MAX_DEVICES;
   \                     gNWK_MAX_DEVICE_LIST:
   \   000000   1500         DW 21
    111          
    112          // Variables for MAX Sleeping End Devices

   \                                 In  segment CODE_C, align 1
    113          CONST uint8 gNWK_MAX_SLEEPING_END_DEVICES = NWK_MAX_DEVICES - NWK_MAX_ROUTERS;
   \                     gNWK_MAX_SLEEPING_END_DEVICES:
   \   000000   0F           DB 15
    114          
    115          // Variables for MAX data buffer levels

   \                                 In  segment CODE_C, align 1
    116          CONST uint8 gNWK_MAX_DATABUFS_WAITING = NWK_MAX_DATABUFS_WAITING;
   \                     gNWK_MAX_DATABUFS_WAITING:
   \   000000   08           DB 8

   \                                 In  segment CODE_C, align 1
    117          CONST uint8 gNWK_MAX_DATABUFS_SCHEDULED = NWK_MAX_DATABUFS_SCHEDULED;
   \                     gNWK_MAX_DATABUFS_SCHEDULED:
   \   000000   05           DB 5

   \                                 In  segment CODE_C, align 1
    118          CONST uint8 gNWK_MAX_DATABUFS_CONFIRMED = NWK_MAX_DATABUFS_CONFIRMED;
   \                     gNWK_MAX_DATABUFS_CONFIRMED:
   \   000000   05           DB 5

   \                                 In  segment CODE_C, align 1
    119          CONST uint8 gNWK_MAX_DATABUFS_TOTAL = NWK_MAX_DATABUFS_TOTAL;
   \                     gNWK_MAX_DATABUFS_TOTAL:
   \   000000   0C           DB 12
    120          

   \                                 In  segment CODE_C, align 1
    121          CONST uint8 gNWK_INDIRECT_CNT_RTG_TMR = NWK_INDIRECT_CNT_RTG_TMR;
   \                     gNWK_INDIRECT_CNT_RTG_TMR:
   \   000000   01           DB 1

   \                                 In  segment CODE_C, align 1
    122          CONST uint8 gNWK_INDIRECT_MSG_MAX_PER = NWK_INDIRECT_MSG_MAX_PER;
   \                     gNWK_INDIRECT_MSG_MAX_PER:
   \   000000   03           DB 3

   \                                 In  segment CODE_C, align 1
    123          CONST uint8 gNWK_INDIRECT_MSG_MAX_ALL = NWK_INDIRECT_MSG_MAX_ALL;
   \                     gNWK_INDIRECT_MSG_MAX_ALL:
   \   000000   09           DB 9
    124          
    125          // change this if using a different stack profile...
    126          // Cskip array

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    127          uint16 *Cskip;
   \                     Cskip:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    128          
    129          #if ( STACK_PROFILE_ID == ZIGBEEPRO_PROFILE )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    130            uint8 CskipRtrs[1] = {0};
   \                     CskipRtrs:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    131            uint8 CskipChldrn[1] = {0};
   \                     CskipChldrn:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    132          #elif ( STACK_PROFILE_ID == HOME_CONTROLS )
    133            uint8 CskipRtrs[MAX_NODE_DEPTH+1] = {6,6,6,6,6,0};
    134            uint8 CskipChldrn[MAX_NODE_DEPTH+1] = {20,20,20,20,20,0};
    135          #elif ( STACK_PROFILE_ID == GENERIC_STAR )
    136            uint8 CskipRtrs[MAX_NODE_DEPTH+1] = {5,5,5,5,5,0};
    137            uint8 CskipChldrn[MAX_NODE_DEPTH+1] = {5,5,5,5,5,0};
    138          #elif ( STACK_PROFILE_ID == NETWORK_SPECIFIC )
    139            uint8 CskipRtrs[MAX_NODE_DEPTH+1] = {5,5,5,5,5,0};
    140            uint8 CskipChldrn[MAX_NODE_DEPTH+1] = {5,5,5,5,5,0};
    141          #endif // STACK_PROFILE_ID
    142          
    143          // Minimum lqi value that is required for association

   \                                 In  segment XDATA_I, align 1, keep-with-next
    144          uint8 gMIN_TREE_LINK_COST = MIN_LQI_COST_3;
   \                     gMIN_TREE_LINK_COST:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for gMIN_TREE_LINK_COST>`
   \   000001                REQUIRE __INIT_XDATA_I
    145          
    146          // Statically defined Associated Device List

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    147          associated_devices_t AssociatedDevList[NWK_MAX_DEVICES];
   \                     AssociatedDevList:
   \   000000                DS 378
   \   00017A                REQUIRE __INIT_XDATA_Z
    148          

   \                                 In  segment CODE_C, align 1
    149          CONST uint8 gMAX_RTG_ENTRIES = MAX_RTG_ENTRIES;
   \                     gMAX_RTG_ENTRIES:
   \   000000   28           DB 40

   \                                 In  segment CODE_C, align 1
    150          CONST uint8 gMAX_RTG_SRC_ENTRIES = MAX_RTG_SRC_ENTRIES;
   \                     gMAX_RTG_SRC_ENTRIES:
   \   000000   0C           DB 12

   \                                 In  segment CODE_C, align 1
    151          CONST uint8 gMAX_RREQ_ENTRIES = MAX_RREQ_ENTRIES;
   \                     gMAX_RREQ_ENTRIES:
   \   000000   08           DB 8
    152          

   \                                 In  segment CODE_C, align 1
    153          CONST uint8 gMAX_NEIGHBOR_ENTRIES = MAX_NEIGHBOR_ENTRIES;
   \                     gMAX_NEIGHBOR_ENTRIES:
   \   000000   10           DB 16
    154          
    155           // Table of neighboring nodes (not including child nodes)

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    156          neighborEntry_t neighborTable[MAX_NEIGHBOR_ENTRIES];
   \                     neighborTable:
   \   000000                DS 368
   \   000170                REQUIRE __INIT_XDATA_Z
    157          

   \                                 In  segment CODE_C, align 1
    158          CONST uint8 gMAX_SOURCE_ROUTE = MAX_SOURCE_ROUTE;
   \                     gMAX_SOURCE_ROUTE:
   \   000000   0C           DB 12
    159          

   \                                 In  segment CODE_C, align 1
    160          CONST uint8 gMAX_BROADCAST_QUEUED = MAX_BROADCAST_QUEUED;
   \                     gMAX_BROADCAST_QUEUED:
   \   000000   0A           DB 10
    161          
    162          // Routing table

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    163          rtgEntry_t rtgTable[MAX_RTG_ENTRIES];
   \                     rtgTable:
   \   000000                DS 280
   \   000118                REQUIRE __INIT_XDATA_Z
    164          
    165          #if defined ( ZIGBEE_SOURCE_ROUTING )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    166            rtgSrcEntry_t rtgSrcTable[MAX_RTG_SRC_ENTRIES];
   \                     rtgSrcTable:
   \   000000                DS 72
   \   000048                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    167            uint16 rtgSrcRelayList[MAX_SOURCE_ROUTE];
   \                     rtgSrcRelayList:
   \   000000                DS 24
   \   000018                REQUIRE __INIT_XDATA_Z
    168          #endif
    169          
    170          // Table of current RREQ packets in the network

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    171          rtDiscEntry_t rtDiscTable[MAX_RREQ_ENTRIES];
   \                     rtDiscTable:
   \   000000                DS 64
   \   000040                REQUIRE __INIT_XDATA_Z
    172          
    173          // Table of data broadcast packets currently in circulation.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    174          bcastEntry_t bcastTable[MAX_BCAST];
   \                     bcastTable:
   \   000000                DS 72
   \   000048                REQUIRE __INIT_XDATA_Z
    175          
    176          // These 2 arrays are to be used as an array of struct { uint8, uint32 }.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    177          uint8 bcastHoldHandle[MAX_BCAST];
   \                     bcastHoldHandle:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    178          uint32 bcastHoldAckMask[MAX_BCAST];
   \                     bcastHoldAckMask:
   \   000000                DS 36
   \   000024                REQUIRE __INIT_XDATA_Z
    179          

   \                                 In  segment CODE_C, align 1
    180          CONST uint8 gMAX_BCAST = MAX_BCAST;
   \                     gMAX_BCAST:
   \   000000   09           DB 9
    181          
    182          // For tree addressing, this switch allows the allocation of a 
    183          // router address to an end device when end device address are 
    184          // all used up.  If this option is enabled, address space
    185          // could be limited.

   \                                 In  segment CODE_C, align 1
    186          CONST uint8 gNWK_TREE_ALLOCATE_ROUTERADDR_FOR_ENDDEVICE = FALSE;
   \                     gNWK_TREE_ALLOCATE_ROUTERADDR_FOR_ENDDEVICE:
   \   000000   00           DB 0
    187          
    188          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
    189          // number of link status periods after the last received address conflict report
    190          // (network status command)

   \                                 In  segment CODE_C, align 1
    191          CONST uint8 gNWK_CONFLICTED_ADDR_EXPIRY_TIME = NWK_CONFLICTED_ADDR_EXPIRY_TIME;
   \                     gNWK_CONFLICTED_ADDR_EXPIRY_TIME:
   \   000000   04           DB 4
    192          #endif
    193          
    194          #if defined ( ZIGBEE_FREQ_AGILITY )

   \                                 In  segment CODE_C, align 1
    195          CONST uint8 gNWK_FREQ_AGILITY_ALL_MAC_ERRS = NWK_FREQ_AGILITY_ALL_MAC_ERRS;
   \                     gNWK_FREQ_AGILITY_ALL_MAC_ERRS:
   \   000000   00           DB 0
    196          #endif
    197            
    198          /*********************************************************************
    199           * APS GLOBAL VARIABLES
    200           */
    201          
    202          // The Maximum number of binding records
    203          // This number is defined in BindingTable.h - change it there.

   \                                 In  segment CODE_C, align 1
    204          CONST uint16 gNWK_MAX_BINDING_ENTRIES = NWK_MAX_BINDING_ENTRIES;
   \                     gNWK_MAX_BINDING_ENTRIES:
   \   000000   0400         DW 4
    205          
    206          #if defined ( REFLECTOR )
    207            // The Maximum number of cluster IDs in a binding record
    208            // This number is defined in BindingTable.h - change it there.

   \                                 In  segment CODE_C, align 1
    209            CONST uint8 gMAX_BINDING_CLUSTER_IDS = MAX_BINDING_CLUSTER_IDS;
   \                     gMAX_BINDING_CLUSTER_IDS:
   \   000000   04           DB 4
    210          

   \                                 In  segment CODE_C, align 1
    211            CONST uint16 gBIND_REC_SIZE = sizeof( BindingEntry_t );
   \                     gBIND_REC_SIZE:
   \   000000   0E00         DW 14
    212          
    213            // Binding Table

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    214            BindingEntry_t BindingTable[NWK_MAX_BINDING_ENTRIES];
   \                     BindingTable:
   \   000000                DS 56
   \   000038                REQUIRE __INIT_XDATA_Z
    215          #endif
    216          
    217          // Maximum number allowed in the groups table.

   \                                 In  segment CODE_C, align 1
    218          CONST uint8 gAPS_MAX_GROUPS = APS_MAX_GROUPS;
   \                     gAPS_MAX_GROUPS:
   \   000000   10           DB 16
    219          
    220          // APS End Device Broadcast Table
    221          #if ( ZG_BUILD_ENDDEVICE_TYPE )
    222            apsEndDeviceBroadcast_t apsEndDeviceBroadcastTable[APS_MAX_ENDDEVICE_BROADCAST_ENTRIES];
    223            uint8 gAPS_MAX_ENDDEVICE_BROADCAST_ENTRIES = APS_MAX_ENDDEVICE_BROADCAST_ENTRIES;
    224          #endif
    225          
    226          /*********************************************************************
    227           * SECURITY GLOBAL VARIABLES
    228           */
    229          
    230          // This is the default pre-configured key,
    231          // change this to make a unique key
    232          // SEC_KEY_LEN is defined in ssp.h.

   \                                 In  segment CODE_C, align 1
    233          CONST uint8 defaultKey[SEC_KEY_LEN] =
   \                     defaultKey:
   \   000000   00           DB 0
   \   000001   01           DB 1
   \   000002   02           DB 2
   \   000003   03           DB 3
   \   000004   04           DB 4
   \   000005   05           DB 5
   \   000006   06           DB 6
   \   000007   07           DB 7
   \   000008   08           DB 8
   \   000009   09           DB 9
   \   00000A   0A           DB 10
   \   00000B   0B           DB 11
   \   00000C   0C           DB 12
   \   00000D   0D           DB 13
   \   00000E   0E           DB 14
   \   00000F   0F           DB 15
    234          {
    235          #if defined ( APP_TP ) || defined ( APP_TP2 )
    236            // Key for ZigBee Conformance Testing
    237            0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0xbb,
    238            0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa
    239          #else
    240            // Key for In-House Testing
    241            0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    242            0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F
    243          #endif
    244          };
    245          
    246          // This is the default pre-configured Trust Center Link key,
    247          // change this to make a unique key, SEC_KEY_LEN is defined in ssp.h.

   \                                 In  segment CODE_C, align 1
    248          CONST uint8 defaultTCLinkKey[SEC_KEY_LEN] =
   \                     defaultTCLinkKey:
   \   000000   56           DB 86
   \   000001   77           DB 119
   \   000002   77           DB 119
   \   000003   77           DB 119
   \   000004   77           DB 119
   \   000005   77           DB 119
   \   000006   77           DB 119
   \   000007   77           DB 119
   \   000008   77           DB 119
   \   000009   77           DB 119
   \   00000A   77           DB 119
   \   00000B   77           DB 119
   \   00000C   77           DB 119
   \   00000D   77           DB 119
   \   00000E   77           DB 119
   \   00000F   77           DB 119
    249          {
    250            0x56, 0x77, 0x77, 0x77, 0x77, 0x77, 0x77, 0x77,
    251            0x77, 0x77, 0x77, 0x77, 0x77, 0x77, 0x77, 0x77
    252          };
    253          
    254          /*********************************************************************
    255           * STATUS STRINGS
    256           */
    257          #if defined ( LCD_SUPPORTED )

   \                                 In  segment XDATA_ROM_C, align 1
    258            const char PingStr[]         = "Ping Rcvd from";
   \                     PingStr:
   \   000000   50696E67     DB "Ping Rcvd from"
   \            20526376
   \            64206672
   \            6F6D00  

   \                                 In  segment XDATA_ROM_C, align 1
    259            const char AssocCnfStr[]     = "Assoc Cnf";
   \                     AssocCnfStr:
   \   000000   4173736F     DB "Assoc Cnf"
   \            6320436E
   \            6600    

   \                                 In  segment XDATA_ROM_C, align 1
    260            const char SuccessStr[]      = "Success";
   \                     SuccessStr:
   \   000000   53756363     DB "Success"
   \            65737300

   \                                 In  segment XDATA_ROM_C, align 1
    261            const char EndDeviceStr[]    = "EndDevice:";
   \                     EndDeviceStr:
   \   000000   456E6444     DB "EndDevice:"
   \            65766963
   \            653A00  

   \                                 In  segment XDATA_ROM_C, align 1
    262            const char ParentStr[]       = "Parent:";
   \                     ParentStr:
   \   000000   50617265     DB "Parent:"
   \            6E743A00

   \                                 In  segment XDATA_ROM_C, align 1
    263            const char ZigbeeCoordStr[]  = "ZigBee Coord";
   \                     ZigbeeCoordStr:
   \   000000   5A696742     DB "ZigBee Coord"
   \            65652043
   \            6F6F7264
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
    264            const char NetworkIDStr[]    = "Network ID:";
   \                     NetworkIDStr:
   \   000000   4E657477     DB "Network ID:"
   \            6F726B20
   \            49443A00

   \                                 In  segment XDATA_ROM_C, align 1
    265            const char RouterStr[]       = "Router:";
   \                     RouterStr:
   \   000000   526F7574     DB "Router:"
   \            65723A00

   \                                 In  segment XDATA_ROM_C, align 1
    266            const char OrphanRspStr[]    = "Orphan Response";
   \                     OrphanRspStr:
   \   000000   4F727068     DB "Orphan Response"
   \            616E2052
   \            6573706F
   \            6E736500

   \                                 In  segment XDATA_ROM_C, align 1
    267            const char SentStr[]         = "Sent";
   \                     SentStr:
   \   000000   53656E74     DB "Sent"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
    268            const char FailedStr[]       = "Failed";
   \                     FailedStr:
   \   000000   4661696C     DB "Failed"
   \            656400  

   \                                 In  segment XDATA_ROM_C, align 1
    269            const char AssocRspFailStr[] = "Assoc Rsp fail";
   \                     AssocRspFailStr:
   \   000000   4173736F     DB "Assoc Rsp fail"
   \            63205273
   \            70206661
   \            696C00  

   \                                 In  segment XDATA_ROM_C, align 1
    270            const char AssocIndStr[]     = "Assoc Ind";
   \                     AssocIndStr:
   \   000000   4173736F     DB "Assoc Ind"
   \            6320496E
   \            6400    

   \                                 In  segment XDATA_ROM_C, align 1
    271            const char AssocCnfFailStr[] = "Assoc Cnf fail";
   \                     AssocCnfFailStr:
   \   000000   4173736F     DB "Assoc Cnf fail"
   \            6320436E
   \            66206661
   \            696C00  

   \                                 In  segment XDATA_ROM_C, align 1
    272            const char EnergyLevelStr[]  = "Energy Level";
   \                     EnergyLevelStr:
   \   000000   456E6572     DB "Energy Level"
   \            6779204C
   \            6576656C
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
    273            const char ScanFailedStr[]   = "Scan Failed";
   \                     ScanFailedStr:
   \   000000   5363616E     DB "Scan Failed"
   \            20466169
   \            6C656400
    274          #endif
    275          
    276          /*********************************************************************
    277           * @fn       nwk_globals_init()
    278           *
    279           * @brief
    280           *
    281           *   Initialize nwk layer globals.  These are the system defaults and
    282           *   should be changed by the user here.  The default definitions are
    283           *   defined in nwk.h or NLMEDE.h.
    284           *
    285           * @param   none
    286           *
    287           * @return  none
    288           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    289          void nwk_globals_init( void )
   \                     nwk_globals_init:
    290          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    291            AddrMgrInit( NWK_MAX_ADDRESSES );
   \   000004                ; Setup parameters for call to function AddrMgrInit
   \   000004   7A1A         MOV     R2,#0x1a
   \   000006   7B00         MOV     R3,#0x0
   \   000008   12....       LCALL   ??AddrMgrInit?relay
    292            
    293          #if !defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
    294            if ( ZSTACK_ROUTER_BUILD )
    295            {
    296              // Initialize the Cskip Table
    297              Cskip = osal_mem_alloc(sizeof(uint16) *(MAX_NODE_DEPTH+1));
    298              RTG_FillCSkipTable(CskipChldrn, CskipRtrs, MAX_NODE_DEPTH, Cskip);
    299            }
    300          #endif
    301            
    302            // To compile out the Link Status Feature, set NWK_LINK_STATUS_PERIOD
    303            // to 0 (compiler flag).
    304            if ( ZSTACK_ROUTER_BUILD && NWK_LINK_STATUS_PERIOD )
    305            {
    306              NLME_InitLinkStatus();
   \   00000B                ; Setup parameters for call to function NLME_InitLinkStatus
   \   00000B   12....       LCALL   ??NLME_InitLinkStatus?relay
    307            }
    308            
    309          #if defined ( ZIGBEE_FREQ_AGILITY )
    310            NwkFreqAgilityInit();
   \   00000E                ; Setup parameters for call to function NwkFreqAgilityInit
   \   00000E   12....       LCALL   ??NwkFreqAgilityInit?relay
    311          #endif
    312          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    313          
    314          /*********************************************************************
    315           * @fn       NIB_init()
    316           *
    317           * @brief
    318           *
    319           *   Initialize attribute values in NIB
    320           *
    321           * @param   none
    322           *
    323           * @return  none
    324           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    325          void NIB_init()
   \                     NIB_init:
    326          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    327            _NIB.SequenceNum = LO_UINT16(osal_rand());
   \   000004                ; Setup parameters for call to function osal_rand
   \   000004   12....       LCALL   ??osal_rand?relay
   \   000007   EA           MOV     A,R2
   \   000008   90....       MOV     DPTR,#_NIB
   \   00000B   F0           MOVX    @DPTR,A
    328          
    329            _NIB.nwkProtocolVersion = ZB_PROT_VERS;
   \   00000C   90....       MOV     DPTR,#_NIB + 17
   \   00000F   7402         MOV     A,#0x2
   \   000011   F0           MOVX    @DPTR,A
    330            _NIB.MaxDepth = MAX_NODE_DEPTH;
   \   000012   90....       MOV     DPTR,#_NIB + 4
   \   000015   7414         MOV     A,#0x14
   \   000017   F0           MOVX    @DPTR,A
    331          
    332          #if ( NWK_MODE == NWK_MODE_MESH )
    333            _NIB.beaconOrder = BEACON_ORDER_NO_BEACONS;
   \   000018   90....       MOV     DPTR,#_NIB + 40
   \   00001B   740F         MOV     A,#0xf
   \   00001D   F0           MOVX    @DPTR,A
    334            _NIB.superFrameOrder = BEACON_ORDER_NO_BEACONS;
   \   00001E   90....       MOV     DPTR,#_NIB + 41
   \   000021   740F         MOV     A,#0xf
   \   000023   F0           MOVX    @DPTR,A
    335          #endif
    336          
    337            // BROADCAST SETTINGS:
    338            // *******************
    339            //   Broadcast Delivery Time
    340            //     - set to multiples of 100ms 
    341            //     - should be 500ms more than the retry time
    342            //       -  "retry time" = PassiveAckTimeout * (MaxBroadcastRetries + 1)
    343            //   Passive Ack Timeout
    344            //     - set to multiples of 100ms 
    345            _NIB.BroadcastDeliveryTime = zgBcastDeliveryTime;
   \   000024   90....       MOV     DPTR,#zgBcastDeliveryTime
   \   000027   E0           MOVX    A,@DPTR
   \   000028   90....       MOV     DPTR,#_NIB + 7
   \   00002B   F0           MOVX    @DPTR,A
    346            _NIB.PassiveAckTimeout     = zgPassiveAckTimeout;
   \   00002C   90....       MOV     DPTR,#zgPassiveAckTimeout
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   90....       MOV     DPTR,#_NIB + 1
   \   000033   F0           MOVX    @DPTR,A
    347            _NIB.MaxBroadcastRetries   = zgMaxBcastRetires;
   \   000034   90....       MOV     DPTR,#zgMaxBcastRetires
   \   000037   E0           MOVX    A,@DPTR
   \   000038   90....       MOV     DPTR,#_NIB + 2
   \   00003B   F0           MOVX    @DPTR,A
    348          
    349            _NIB.ReportConstantCost = 0;
   \   00003C   90....       MOV     DPTR,#_NIB + 8
   \   00003F   7400         MOV     A,#0x0
   \   000041   F0           MOVX    @DPTR,A
    350            _NIB.RouteDiscRetries = 0;
   \   000042   90....       MOV     DPTR,#_NIB + 9
   \   000045   7400         MOV     A,#0x0
   \   000047   F0           MOVX    @DPTR,A
    351            _NIB.SecureAllFrames = USE_NWK_SECURITY;
   \   000048   90....       MOV     DPTR,#_NIB + 11
   \   00004B   7400         MOV     A,#0x0
   \   00004D   F0           MOVX    @DPTR,A
    352            _NIB.nwkAllFresh = NWK_ALL_FRESH;
   \   00004E   90....       MOV     DPTR,#_NIB + 104
   \   000051   7401         MOV     A,#0x1
   \   000053   F0           MOVX    @DPTR,A
    353             
    354            if ( ZG_SECURE_ENABLED )
    355            {
    356              _NIB.SecurityLevel = SECURITY_LEVEL;
    357            }
    358            else
    359            {
    360              _NIB.SecurityLevel = 0;
   \   000054   90....       MOV     DPTR,#_NIB + 12
   \   000057   7400         MOV     A,#0x0
   \   000059   F0           MOVX    @DPTR,A
    361            }
    362             
    363          #if defined ( ZIGBEEPRO )
    364            _NIB.SymLink = FALSE;
   \   00005A   90....       MOV     DPTR,#_NIB + 13
   \   00005D   7400         MOV     A,#0x0
   \   00005F   F0           MOVX    @DPTR,A
    365          #else
    366            _NIB.SymLink = TRUE;
    367          #endif  
    368            
    369            _NIB.CapabilityInfo = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   000060   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000063   E0           MOVX    A,@DPTR
   \   000064   90....       MOV     DPTR,#_NIB + 14
   \   000067   F0           MOVX    @DPTR,A
    370          
    371            _NIB.TransactionPersistenceTime = zgIndirectMsgTimeout;
   \   000068   90....       MOV     DPTR,#zgIndirectMsgTimeout
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   F8           MOV     R0,A
   \   00006D   7900         MOV     R1,#0x0
   \   00006F   90....       MOV     DPTR,#_NIB + 15
   \   000072   F0           MOVX    @DPTR,A
   \   000073   A3           INC     DPTR
   \   000074   E9           MOV     A,R1
   \   000075   F0           MOVX    @DPTR,A
    372          
    373            _NIB.RouteDiscoveryTime = 5;
   \   000076   90....       MOV     DPTR,#_NIB + 18
   \   000079   7405         MOV     A,#0x5
   \   00007B   F0           MOVX    @DPTR,A
    374            _NIB.RouteExpiryTime = zgRouteExpiryTime;
   \   00007C   90....       MOV     DPTR,#zgRouteExpiryTime
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   90....       MOV     DPTR,#_NIB + 19
   \   000083   F0           MOVX    @DPTR,A
    375          
    376            _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   000084   90....       MOV     DPTR,#_NIB + 20
   \   000087   74FE         MOV     A,#-0x2
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   A3           INC     DPTR
   \   00008B   74FF         MOV     A,#-0x1
   \   00008D   F0           MOVX    @DPTR,A
    377            _NIB.nwkLogicalChannel = 0;
   \   00008E   90....       MOV     DPTR,#_NIB + 22
   \   000091   7400         MOV     A,#0x0
   \   000093   F0           MOVX    @DPTR,A
    378            _NIB.nwkCoordAddress = INVALID_NODE_ADDR;
   \   000094   90....       MOV     DPTR,#_NIB + 23
   \   000097   74FE         MOV     A,#-0x2
   \   000099   F0           MOVX    @DPTR,A
   \   00009A   A3           INC     DPTR
   \   00009B   74FF         MOV     A,#-0x1
   \   00009D   F0           MOVX    @DPTR,A
    379            osal_memset( _NIB.nwkCoordExtAddress, 0, Z_EXTADDR_LEN );
   \   00009E                ; Setup parameters for call to function osal_memset
   \   00009E   7C08         MOV     R4,#0x8
   \   0000A0   7D00         MOV     R5,#0x0
   \   0000A2   7900         MOV     R1,#0x0
   \   0000A4   7A..         MOV     R2,#(_NIB + 25) & 0xff
   \   0000A6   7B..         MOV     R3,#((_NIB + 25) >> 8) & 0xff
   \   0000A8   12....       LCALL   ??osal_memset?relay
    380            _NIB.nwkPanId = INVALID_NODE_ADDR;
   \   0000AB   90....       MOV     DPTR,#_NIB + 33
   \   0000AE   74FE         MOV     A,#-0x2
   \   0000B0   F0           MOVX    @DPTR,A
   \   0000B1   A3           INC     DPTR
   \   0000B2   74FF         MOV     A,#-0x1
   \   0000B4   F0           MOVX    @DPTR,A
    381          
    382            osal_cpyExtAddr( _NIB.extendedPANID, zgExtendedPANID );
   \   0000B5                ; Setup parameters for call to function sAddrExtCpy
   \   0000B5   7C..         MOV     R4,#zgExtendedPANID & 0xff
   \   0000B7   7D..         MOV     R5,#(zgExtendedPANID >> 8) & 0xff
   \   0000B9   7A..         MOV     R2,#(_NIB + 53) & 0xff
   \   0000BB   7B..         MOV     R3,#((_NIB + 53) >> 8) & 0xff
   \   0000BD   12....       LCALL   ??sAddrExtCpy?relay
    383             
    384            _NIB.nwkKeyLoaded = FALSE;
   \   0000C0   90....       MOV     DPTR,#_NIB + 61
   \   0000C3   7400         MOV     A,#0x0
   \   0000C5   F0           MOVX    @DPTR,A
    385             
    386          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
    387            _NIB.nwkAddrAlloc  = NWK_ADDRESSING_STOCHASTIC;
   \   0000C6   90....       MOV     DPTR,#_NIB + 96
   \   0000C9   7402         MOV     A,#0x2
   \   0000CB   F0           MOVX    @DPTR,A
    388            _NIB.nwkUniqueAddr = FALSE;
   \   0000CC   90....       MOV     DPTR,#_NIB + 97
   \   0000CF   7400         MOV     A,#0x0
   \   0000D1   F0           MOVX    @DPTR,A
    389          #else
    390            _NIB.nwkAddrAlloc  = NWK_ADDRESSING_DISTRIBUTED;
    391            _NIB.nwkUniqueAddr = TRUE;
    392          #endif
    393          
    394            _NIB.nwkLinkStatusPeriod = NWK_LINK_STATUS_PERIOD; 
   \   0000D2   90....       MOV     DPTR,#_NIB + 98
   \   0000D5   740F         MOV     A,#0xf
   \   0000D7   F0           MOVX    @DPTR,A
    395            _NIB.nwkRouterAgeLimit = NWK_ROUTE_AGE_LIMIT;
   \   0000D8   90....       MOV     DPTR,#_NIB + 99
   \   0000DB   7403         MOV     A,#0x3
   \   0000DD   F0           MOVX    @DPTR,A
    396           
    397            //MTO and source routing
    398            _NIB.nwkConcentratorDiscoveryTime = zgConcentratorDiscoveryTime;
   \   0000DE   90....       MOV     DPTR,#zgConcentratorDiscoveryTime
   \   0000E1   E0           MOVX    A,@DPTR
   \   0000E2   90....       MOV     DPTR,#_NIB + 102
   \   0000E5   F0           MOVX    @DPTR,A
    399            _NIB.nwkIsConcentrator = zgConcentratorEnable;
   \   0000E6   90....       MOV     DPTR,#zgConcentratorEnable
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   90....       MOV     DPTR,#_NIB + 101
   \   0000ED   F0           MOVX    @DPTR,A
    400            _NIB.nwkConcentratorRadius = zgConcentratorRadius;
   \   0000EE   90....       MOV     DPTR,#zgConcentratorRadius
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   90....       MOV     DPTR,#_NIB + 103
   \   0000F5   F0           MOVX    @DPTR,A
    401            _NIB.nwkSrcRtgExpiryTime = SRC_RTG_EXPIRY_TIME;
   \   0000F6   90....       MOV     DPTR,#_NIB + 105
   \   0000F9   740A         MOV     A,#0xa
   \   0000FB   F0           MOVX    @DPTR,A
    402          
    403          #if defined ( ZIGBEE_MULTICAST )
    404            _NIB.nwkUseMultiCast = TRUE;
   \   0000FC   90....       MOV     DPTR,#_NIB + 100
   \   0000FF   7401         MOV     A,#0x1
   \   000101   F0           MOVX    @DPTR,A
    405          #else
    406            _NIB.nwkUseMultiCast = FALSE;
    407          #endif  
    408            _NIB.nwkManagerAddr = 0x0000;
   \   000102   90....       MOV     DPTR,#_NIB + 106
   \   000105   7400         MOV     A,#0x0
   \   000107   F0           MOVX    @DPTR,A
   \   000108   A3           INC     DPTR
   \   000109   7400         MOV     A,#0x0
   \   00010B   F0           MOVX    @DPTR,A
    409            _NIB.nwkUpdateId = 0;
   \   00010C   90....       MOV     DPTR,#_NIB + 110
   \   00010F   7400         MOV     A,#0x0
   \   000111   F0           MOVX    @DPTR,A
    410            _NIB.nwkTotalTransmissions = 0;
   \   000112   90....       MOV     DPTR,#_NIB + 108
   \   000115   7400         MOV     A,#0x0
   \   000117   F0           MOVX    @DPTR,A
   \   000118   A3           INC     DPTR
   \   000119   7400         MOV     A,#0x0
   \   00011B   F0           MOVX    @DPTR,A
    411          
    412            if ( ZSTACK_ROUTER_BUILD )
    413            {
    414          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
    415              NLME_InitStochasticAddressing();
   \   00011C                ; Setup parameters for call to function NLME_InitStochasticAddressing
   \   00011C   12....       LCALL   ??NLME_InitStochasticAddressing?relay
    416          #else
    417              NLME_InitTreeAddressing();
    418          #endif
    419            }
    420          }
   \   00011F   D083         POP     DPH
   \   000121   D082         POP     DPL
   \   000123   02....       LJMP    ?BRET
    421          
    422          /*********************************************************************
    423           * @fn       nwk_Status()
    424           *
    425           * @brief
    426           *
    427           *   Status report.
    428           *
    429           * @param   statusCode
    430           * @param   statusValue
    431           *
    432           * @return  none
    433           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    434          void nwk_Status( uint16 statusCode, uint16 statusValue )
   \                     nwk_Status:
    435          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
    436          #if defined ( LCD_SUPPORTED )
    437            switch ( statusCode )
   \   00000D   8E..         MOV     ?V0 + 2,R6
   \   00000F   8F..         MOV     ?V0 + 3,R7
   \   000011   78..         MOV     R0,#?V0 + 2
   \   000013   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for nwk_Status>_0`:
   \   000016   0000         DW        0
   \   000018   0900         DW        9
   \   00001A   0200         DW        2
   \   00001C   ....         DW        ??nwk_Status_0
   \   00001E   0300         DW        3
   \   000020   ....         DW        ??nwk_Status_1
   \   000022   0400         DW        4
   \   000024   ....         DW        ??nwk_Status_2
   \   000026   0500         DW        5
   \   000028   ....         DW        ??nwk_Status_3
   \   00002A   0600         DW        6
   \   00002C   ....         DW        ??nwk_Status_4
   \   00002E   0700         DW        7
   \   000030   ....         DW        ??nwk_Status_5
   \   000032   0110         DW        4097
   \   000034   ....         DW        ??nwk_Status_6
   \   000036   0310         DW        4099
   \   000038   ....         DW        ??nwk_Status_7
   \   00003A   0410         DW        4100
   \   00003C   ....         DW        ??nwk_Status_8
   \   00003E   ....         DW        ??nwk_Status_1
    438            {
    439              case NWK_STATUS_COORD_ADDR:
    440                if ( ZSTACK_ROUTER_BUILD )
    441                {
    442                  HalLcdWriteString( (char*)ZigbeeCoordStr, HAL_LCD_LINE_1 );
   \                     ??nwk_Status_3:
   \   000040                ; Setup parameters for call to function HalLcdWriteString
   \   000040   7901         MOV     R1,#0x1
   \   000042   7A..         MOV     R2,#ZigbeeCoordStr & 0xff
   \   000044   7B..         MOV     R3,#(ZigbeeCoordStr >> 8) & 0xff
   \   000046   12....       LCALL   ??HalLcdWriteString?relay
    443                  HalLcdWriteStringValue( (char*)NetworkIDStr, statusValue, 16, HAL_LCD_LINE_2 );
   \   000049                ; Setup parameters for call to function HalLcdWriteStringValue
   \   000049   75..02       MOV     ?V0 + 2,#0x2
   \   00004C   78..         MOV     R0,#?V0 + 2
   \   00004E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000051   7910         MOV     R1,#0x10
   \   000053   AC..         MOV     R4,?V0 + 0
   \   000055   AD..         MOV     R5,?V0 + 1
   \   000057   7A..         MOV     R2,#NetworkIDStr & 0xff
   \   000059   7B..         MOV     R3,#(NetworkIDStr >> 8) & 0xff
   \   00005B   12....       LCALL   ??HalLcdWriteStringValue?relay
   \   00005E   7401         MOV     A,#0x1
   \   000060   12....       LCALL   ?DEALLOC_XSTACK8
    444                  BuzzerControl( BUZZER_BLIP );
   \   000063                ; Setup parameters for call to function BuzzerControl
   \   000063   7902         MOV     R1,#0x2
   \   000065   12....       LCALL   ??BuzzerControl?relay
    445                }
    446                break;
   \   000068   02....       LJMP    ??nwk_Status_1 & 0xFFFF
    447          
    448              case NWK_STATUS_ROUTER_ADDR:
    449                if ( ZSTACK_ROUTER_BUILD )
    450                {
    451                  HalLcdWriteStringValue( (char*)RouterStr, statusValue, 16, HAL_LCD_LINE_1 );
   \                     ??nwk_Status_4:
   \   00006B                ; Setup parameters for call to function HalLcdWriteStringValue
   \   00006B   75..01       MOV     ?V0 + 2,#0x1
   \   00006E   78..         MOV     R0,#?V0 + 2
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000073   7910         MOV     R1,#0x10
   \   000075   AC..         MOV     R4,?V0 + 0
   \   000077   AD..         MOV     R5,?V0 + 1
   \   000079   7A..         MOV     R2,#RouterStr & 0xff
   \   00007B   7B..         MOV     R3,#(RouterStr >> 8) & 0xff
   \   00007D   12....       LCALL   ??HalLcdWriteStringValue?relay
   \   000080   7401         MOV     A,#0x1
   \   000082   12....       LCALL   ?DEALLOC_XSTACK8
    452                }
    453                break;
   \   000085   02....       LJMP    ??nwk_Status_1 & 0xFFFF
    454          
    455              case NWK_STATUS_ORPHAN_RSP:
    456                if ( ZSTACK_ROUTER_BUILD )
    457                {
    458                  if ( statusValue == ZSuccess )
   \                     ??nwk_Status_5:
   \   000088   E5..         MOV     A,?V0 + 0
   \   00008A   45..         ORL     A,?V0 + 1
   \   00008C   700D         JNZ     ??nwk_Status_9
    459                    HalLcdWriteScreen( (char*)OrphanRspStr, (char*)SentStr );
   \   00008E                ; Setup parameters for call to function HalLcdWriteScreen
   \   00008E   7C..         MOV     R4,#SentStr & 0xff
   \   000090   7D..         MOV     R5,#(SentStr >> 8) & 0xff
   \   000092   7A..         MOV     R2,#OrphanRspStr & 0xff
   \   000094   7B..         MOV     R3,#(OrphanRspStr >> 8) & 0xff
   \   000096   12....       LCALL   ??HalLcdWriteScreen?relay
   \   000099   800B         SJMP    ??nwk_Status_10
    460                  else
    461                    HalLcdWriteScreen( (char*)OrphanRspStr, (char*)FailedStr );
   \                     ??nwk_Status_9:
   \   00009B                ; Setup parameters for call to function HalLcdWriteScreen
   \   00009B   7C..         MOV     R4,#FailedStr & 0xff
   \   00009D   7D..         MOV     R5,#(FailedStr >> 8) & 0xff
   \   00009F   7A..         MOV     R2,#OrphanRspStr & 0xff
   \   0000A1   7B..         MOV     R3,#(OrphanRspStr >> 8) & 0xff
   \   0000A3   12....       LCALL   ??HalLcdWriteScreen?relay
    462                }
    463                break;
   \                     ??nwk_Status_10:
   \   0000A6   807C         SJMP    ??nwk_Status_1
    464          
    465              case NWK_ERROR_ASSOC_RSP:
    466                if ( ZSTACK_ROUTER_BUILD )
    467                {
    468                  HalLcdWriteString( (char*)AssocRspFailStr, HAL_LCD_LINE_1 );
   \                     ??nwk_Status_6:
   \   0000A8                ; Setup parameters for call to function HalLcdWriteString
   \   0000A8   7901         MOV     R1,#0x1
   \   0000AA   7A..         MOV     R2,#AssocRspFailStr & 0xff
   \   0000AC   7B..         MOV     R3,#(AssocRspFailStr >> 8) & 0xff
   \   0000AE   12....       LCALL   ??HalLcdWriteString?relay
    469                  HalLcdWriteValue( (uint32)(statusValue), 16, HAL_LCD_LINE_2 );
   \   0000B1                ; Setup parameters for call to function HalLcdWriteValue
   \   0000B1   75..02       MOV     ?V0 + 2,#0x2
   \   0000B4   78..         MOV     R0,#?V0 + 2
   \   0000B6   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B9   7910         MOV     R1,#0x10
   \   0000BB   AA..         MOV     R2,?V0 + 0
   \   0000BD   AB..         MOV     R3,?V0 + 1
   \   0000BF   E4           CLR     A
   \   0000C0   FC           MOV     R4,A
   \   0000C1   FD           MOV     R5,A
   \   0000C2   12....       LCALL   ??HalLcdWriteValue?relay
   \   0000C5   7401         MOV     A,#0x1
   \   0000C7   12....       LCALL   ?DEALLOC_XSTACK8
    470                }
    471                break;
   \   0000CA   8058         SJMP    ??nwk_Status_1
    472                
    473              case NWK_STATUS_ED_ADDR:
    474                if ( ZSTACK_END_DEVICE_BUILD )
    475                {
    476                  HalLcdWriteStringValue( (char*)EndDeviceStr, statusValue, 16, HAL_LCD_LINE_1 );
    477                }
    478                break;
    479          
    480              case NWK_STATUS_PARENT_ADDR:
    481                      HalLcdWriteStringValue( (char*)ParentStr, statusValue, 16, HAL_LCD_LINE_2 );
   \                     ??nwk_Status_2:
   \   0000CC                ; Setup parameters for call to function HalLcdWriteStringValue
   \   0000CC   75..02       MOV     ?V0 + 2,#0x2
   \   0000CF   78..         MOV     R0,#?V0 + 2
   \   0000D1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000D4   7910         MOV     R1,#0x10
   \   0000D6   AC..         MOV     R4,?V0 + 0
   \   0000D8   AD..         MOV     R5,?V0 + 1
   \   0000DA   7A..         MOV     R2,#ParentStr & 0xff
   \   0000DC   7B..         MOV     R3,#(ParentStr >> 8) & 0xff
   \   0000DE   12....       LCALL   ??HalLcdWriteStringValue?relay
   \   0000E1   7401         MOV     A,#0x1
   \   0000E3   12....       LCALL   ?DEALLOC_XSTACK8
    482                break;
   \   0000E6   803C         SJMP    ??nwk_Status_1
    483          
    484              case NWK_STATUS_ASSOC_CNF:
    485                HalLcdWriteScreen( (char*)AssocCnfStr, (char*)SuccessStr );
   \                     ??nwk_Status_0:
   \   0000E8                ; Setup parameters for call to function HalLcdWriteScreen
   \   0000E8   7C..         MOV     R4,#SuccessStr & 0xff
   \   0000EA   7D..         MOV     R5,#(SuccessStr >> 8) & 0xff
   \   0000EC   7A..         MOV     R2,#AssocCnfStr & 0xff
   \   0000EE   7B..         MOV     R3,#(AssocCnfStr >> 8) & 0xff
   \   0000F0   12....       LCALL   ??HalLcdWriteScreen?relay
    486                break;
   \   0000F3   802F         SJMP    ??nwk_Status_1
    487          
    488              case NWK_ERROR_ASSOC_CNF_DENIED:
    489                HalLcdWriteString((char*)AssocCnfFailStr, HAL_LCD_LINE_1 );
   \                     ??nwk_Status_7:
   \   0000F5                ; Setup parameters for call to function HalLcdWriteString
   \   0000F5   7901         MOV     R1,#0x1
   \   0000F7   7A..         MOV     R2,#AssocCnfFailStr & 0xff
   \   0000F9   7B..         MOV     R3,#(AssocCnfFailStr >> 8) & 0xff
   \   0000FB   12....       LCALL   ??HalLcdWriteString?relay
    490                HalLcdWriteValue( (uint32)(statusValue), 16, HAL_LCD_LINE_2 );
   \   0000FE                ; Setup parameters for call to function HalLcdWriteValue
   \   0000FE   75..02       MOV     ?V0 + 2,#0x2
   \   000101   78..         MOV     R0,#?V0 + 2
   \   000103   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000106   7910         MOV     R1,#0x10
   \   000108   AA..         MOV     R2,?V0 + 0
   \   00010A   AB..         MOV     R3,?V0 + 1
   \   00010C   E4           CLR     A
   \   00010D   FC           MOV     R4,A
   \   00010E   FD           MOV     R5,A
   \   00010F   12....       LCALL   ??HalLcdWriteValue?relay
   \   000112   7401         MOV     A,#0x1
   \   000114   12....       LCALL   ?DEALLOC_XSTACK8
    491                break;
   \   000117   800B         SJMP    ??nwk_Status_1
    492          
    493              case NWK_ERROR_ENERGY_SCAN_FAILED:
    494                HalLcdWriteScreen( (char*)EnergyLevelStr, (char*)ScanFailedStr );
   \                     ??nwk_Status_8:
   \   000119                ; Setup parameters for call to function HalLcdWriteScreen
   \   000119   7C..         MOV     R4,#ScanFailedStr & 0xff
   \   00011B   7D..         MOV     R5,#(ScanFailedStr >> 8) & 0xff
   \   00011D   7A..         MOV     R2,#EnergyLevelStr & 0xff
   \   00011F   7B..         MOV     R3,#(EnergyLevelStr >> 8) & 0xff
   \   000121   12....       LCALL   ??HalLcdWriteScreen?relay
    495                break;
    496            }
    497          #endif
    498          }
   \                     ??nwk_Status_1:
   \   000124   7F04         MOV     R7,#0x4
   \   000126   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for gMIN_TREE_LINK_COST>`:
   \   000000   06           DB 6

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??nwk_globals_init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    nwk_globals_init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??NIB_init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    NIB_init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??nwk_Status?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    nwk_Status
    499          
    500          /*********************************************************************
    501          *********************************************************************/

   Maximum stack usage in bytes:

   ISTACK PSTACK XSTACK Function
   ------ ------ ------ --------
       2      0      0  NIB_init
                          2 0  0 -> NLME_InitStochasticAddressing
                          2 0  0 -> osal_memset
                          2 0  0 -> osal_rand
                          2 0  0 -> sAddrExtCpy
       0      0     13  nwk_Status
                          0 0 12 -> BuzzerControl
                          0 0 12 -> HalLcdWriteScreen
                          0 0 12 -> HalLcdWriteString
                          0 0 13 -> HalLcdWriteStringValue
                          0 0 13 -> HalLcdWriteValue
       2      0      0  nwk_globals_init
                          2 0  0 -> AddrMgrInit
                          2 0  0 -> NLME_InitLinkStatus
                          2 0  0 -> NwkFreqAgilityInit


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       1  ?<Initializer for gMIN_TREE_LINK_COST>
       6  ??NIB_init?relay
       6  ??nwk_Status?relay
       6  ??nwk_globals_init?relay
      15  AssocCnfFailStr
      10  AssocCnfStr
      10  AssocIndStr
      15  AssocRspFailStr
     378  AssociatedDevList
      56  BindingTable
       2  Cskip
       1  CskipChldrn
       1  CskipRtrs
      11  EndDeviceStr
      13  EnergyLevelStr
       7  FailedStr
     294  NIB_init
      12  NetworkIDStr
      16  OrphanRspStr
       8  ParentStr
      15  PingStr
       8  RouterStr
      12  ScanFailedStr
       5  SentStr
       8  SuccessStr
      13  ZigbeeCoordStr
      36  bcastHoldAckMask
       9  bcastHoldHandle
      72  bcastTable
      16  defaultKey
      16  defaultTCLinkKey
       1  gAPS_MAX_GROUPS
       2  gBIND_REC_SIZE
       1  gMAX_BCAST
       1  gMAX_BINDING_CLUSTER_IDS
       1  gMAX_BROADCAST_QUEUED
       1  gMAX_NEIGHBOR_ENTRIES
       1  gMAX_RREQ_ENTRIES
       1  gMAX_RTG_ENTRIES
       1  gMAX_RTG_SRC_ENTRIES
       1  gMAX_SOURCE_ROUTE
       1  gMIN_TREE_LINK_COST
       1  gNWK_CONFLICTED_ADDR_EXPIRY_TIME
       1  gNWK_FREQ_AGILITY_ALL_MAC_ERRS
       1  gNWK_INDIRECT_CNT_RTG_TMR
       1  gNWK_INDIRECT_MSG_MAX_ALL
       1  gNWK_INDIRECT_MSG_MAX_PER
       2  gNWK_MAX_BINDING_ENTRIES
       1  gNWK_MAX_DATABUFS_CONFIRMED
       1  gNWK_MAX_DATABUFS_SCHEDULED
       1  gNWK_MAX_DATABUFS_TOTAL
       1  gNWK_MAX_DATABUFS_WAITING
       2  gNWK_MAX_DEVICE_LIST
       1  gNWK_MAX_SLEEPING_END_DEVICES
       1  gNWK_TREE_ALLOCATE_ROUTERADDR_FOR_ENDDEVICE
     368  neighborTable
     297  nwk_Status
      24  nwk_globals_init
      64  rtDiscTable
      24  rtgSrcRelayList
      72  rtgSrcTable
     280  rtgTable

 
   615 bytes in segment BANKED_CODE
    18 bytes in segment BANK_RELAYS
    58 bytes in segment CODE_C
     1 byte  in segment XDATA_I
     1 byte  in segment XDATA_ID
   178 bytes in segment XDATA_ROM_C
 1 363 bytes in segment XDATA_Z
 
   692 bytes of CODE  memory
   178 bytes of CONST memory
 1 364 bytes of XDATA memory

Errors: none
Warnings: none
