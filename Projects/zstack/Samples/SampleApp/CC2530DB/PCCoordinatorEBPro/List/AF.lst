###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.20.2.41139 for 8051             05/Jan/2016  16:14:34 #
# Copyright 2004-2013 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#                                                                             #
#    Source file        =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Comp #
#                          onents\stack\af\AF.c                               #
#    Command line       =  -f C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\P #
#                          rojects\zstack\Samples\SampleApp\CC2530DB\..\..\.. #
#                          \Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ           #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f     #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\To #
#                          ols\CC2530DB\f8wConfig.cfg (-DSECURE=0             #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF1                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=TRUE      #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Comp #
#                          onents\stack\af\AF.c -D ZIGBEEPRO -D ZTOOL_P1 -D   #
#                          xMT_TASK -D xMT_SYS_FUNC -D xMT_ZDO_FUNC -D        #
#                          LCD_SUPPORTED=DEBUG -lC C:\Users\ArnoldWorkStation #
#                          \Desktop\ZigbeeTest\Projects\zstack\Samples\Sample #
#                          App\CC2530DB\PCCoordinatorEBPro\List\ -lA          #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\PCCoordinat #
#                          orEBPro\List\ --diag_suppress Pe001,Pa010 -o       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\PCCoordinat #
#                          orEBPro\Obj\ -e --no_cse --no_unroll --no_inline   #
#                          --no_code_motion --no_tbaa --debug --core=plain    #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I C:\Users\ArnoldWorkStation #
#                          \Desktop\ZigbeeTest\Projects\zstack\Samples\Sample #
#                          App\CC2530DB\ -I C:\Users\ArnoldWorkStation\Deskto #
#                          p\ZigbeeTest\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\..\SOURCE\ -I C:\Users\ArnoldWorkStation\Des #
#                          ktop\ZigbeeTest\Projects\zstack\Samples\SampleApp\ #
#                          CC2530DB\..\..\..\ZMAIN\TI2530DB\ -I               #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MT\ -I C:\Users\ArnoldWorkStation\D #
#                          esktop\ZigbeeTest\Projects\zstack\Samples\SampleAp #
#                          p\CC2530DB\..\..\..\..\..\COMPONENTS\HAL\INCLUDE\  #
#                          -I C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\P #
#                          rojects\zstack\Samples\SampleApp\CC2530DB\..\..\.. #
#                          \..\..\COMPONENTS\HAL\TARGET\CC2530EB\ -I          #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\OSAL\MCU\CCSOC\ -I                  #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\OSAL\INCLUDE\ -I                    #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\AF\ -I                        #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\NWK\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SEC\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SAPI\ -I                      #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\SYS\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\STACK\ZDO\ -I                       #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\ZMAC\F8W\ -I                        #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\ZMAC\ -I C:\Users\ArnoldWorkStation #
#                          \Desktop\ZigbeeTest\Projects\zstack\Samples\Sample #
#                          App\CC2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SA #
#                          DDR\ -I C:\Users\ArnoldWorkStation\Desktop\ZigbeeT #
#                          est\Projects\zstack\Samples\SampleApp\CC2530DB\..\ #
#                          ..\..\..\..\COMPONENTS\SERVICES\SDATA\ -I          #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\INCLUDE\ -I                     #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\HIGH_LEVEL\ -I                  #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\LOW_LEVEL\srf04\ -I             #
#                          C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\..\..\.. #
#                          \..\COMPONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\    #
#                          -On --require_prototypes                           #
#    List file          =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\PCCoordinat #
#                          orEBPro\List\AF.lst                                #
#    Object file        =  C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\PCCoordinat #
#                          orEBPro\Obj\AF.r51                                 #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\ArnoldWorkStation\Desktop\ZigbeeTest\Components\stack\af\AF.c
      1          /**************************************************************************************************
      2            Filename:       AF.c
      3            Revised:        $Date: 2009-10-29 00:15:32 -0700 (Thu, 29 Oct 2009) $
      4            Revision:       $Revision: 21013 $
      5          
      6            Description:    Application Framework - Device Description helper functions
      7          
      8          
      9            Copyright 2004-2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41           * INCLUDES
     42           */
     43          
     44          #include "OSAL.h"
     45          #include "AF.h"
     46          #include "nwk_globals.h"
     47          #include "nwk_util.h"
     48          #include "aps_groups.h"
     49          #include "ZDProfile.h"
     50          #include "aps_frag.h"
     51          #include "rtg.h"
     52          
     53          #if defined ( MT_AF_CB_FUNC )
     54            #include "MT_AF.h"
     55          #endif
     56          
     57          #if defined ( INTER_PAN )
     58            #include "stub_aps.h"
     59          #endif
     60          
     61          /*********************************************************************
     62           * MACROS
     63           */
     64          
     65          /*********************************************************************
     66           * @fn      afSend
     67           *
     68           * @brief   Helper macro for V1 API to invoke V2 API.
     69           *
     70           * input parameters
     71           *
     72           * @param  *dstAddr - Full ZB destination address: Nwk Addr + End Point.
     73           * @param   srcEP - Origination (i.e. respond to or ack to) End Point.
     74           * @param   cID - A valid cluster ID as specified by the Profile.
     75           * @param   len - Number of bytes of data pointed to by next param.
     76           * @param  *buf - A pointer to the data bytes to send.
     77           * @param   options - Valid bit mask of AF Tx Options as defined in AF.h.
     78           * @param  *transID - A pointer to a byte which can be modified and which will
     79           *                    be used as the transaction sequence number of the msg.
     80           *
     81           * output parameters
     82           *
     83           * @param  *transID - Incremented by one if the return value is success.
     84           *
     85           * @return  afStatus_t - See previous definition of afStatus_... types.
     86           */
     87          #define afSend( dstAddr, srcEP, cID, len, buf, transID, options, radius ) \
     88                  AF_DataRequest( (dstAddr), afFindEndPointDesc( (srcEP) ), \
     89                                    (cID), (len), (buf), (transID), (options), (radius) )
     90          
     91          /*********************************************************************
     92           * CONSTANTS
     93           */
     94          
     95          /*********************************************************************
     96           * TYPEDEFS
     97           */
     98          
     99          /*********************************************************************
    100           * GLOBAL VARIABLES
    101           */
    102          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    103          epList_t *epList;
   \                     epList:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    104          
    105          /*********************************************************************
    106           * EXTERNAL VARIABLES
    107           */
    108          
    109          /*********************************************************************
    110           * EXTERNAL FUNCTIONS
    111           */
    112          
    113          /*********************************************************************
    114           * LOCAL VARIABLES
    115           */
    116          
    117          /*********************************************************************
    118           * LOCAL FUNCTIONS
    119           */
    120          
    121          static void afBuildMSGIncoming( aps_FrameFormat_t *aff, endPointDesc_t *epDesc,
    122                          zAddrType_t *SrcAddress, uint16 SrcPanId, NLDE_Signal_t *sig,
    123                          byte SecurityUse, uint32 timestamp );
    124          
    125          static epList_t *afFindEndPointDescList( byte EndPoint );
    126          
    127          static pDescCB afGetDescCB( endPointDesc_t *epDesc );
    128          
    129          /*********************************************************************
    130           * NETWORK LAYER CALLBACKS
    131           */
    132          
    133          /*********************************************************************
    134           * PUBLIC FUNCTIONS
    135           */
    136          
    137          /*********************************************************************
    138           * @fn      afInit
    139           *
    140           * @brief   Initialization function for the AF.
    141           *
    142           * @param   none
    143           *
    144           * @return  none
    145           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    146          void afInit( void )
   \                     afInit:
    147          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    148            // Start with no endpoint defined
    149            epList = NULL;
   \   000004   90....       MOV     DPTR,#epList
   \   000007   7400         MOV     A,#0x0
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   7400         MOV     A,#0x0
   \   00000D   F0           MOVX    @DPTR,A
    150          }
   \   00000E   D083         POP     DPH
   \   000010   D082         POP     DPL
   \   000012   02....       LJMP    ?BRET
    151          
    152          /*********************************************************************
    153           * @fn      afRegisterExtended
    154           *
    155           * @brief   Register an Application's EndPoint description.
    156           *
    157           * @param   epDesc - pointer to the Application's endpoint descriptor.
    158           * @param   descFn - pointer to descriptor callback function
    159           *
    160           * NOTE:  The memory that epDesc is pointing to must exist after this call.
    161           *
    162           * @return  Pointer to epList_t on success, NULL otherwise.
    163           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    164          epList_t *afRegisterExtended( endPointDesc_t *epDesc, pDescCB descFn )
   \                     afRegisterExtended:
    165          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   8C..         MOV     ?V0 + 2,R4
   \   00000B   8D..         MOV     ?V0 + 3,R5
    166            epList_t *ep;
    167            epList_t *epSearch;
    168          
    169            ep = osal_mem_alloc( sizeof ( epList_t ) );
   \   00000D                ; Setup parameters for call to function osal_mem_alloc
   \   00000D   7A07         MOV     R2,#0x7
   \   00000F   7B00         MOV     R3,#0x0
   \   000011   12....       LCALL   ??osal_mem_alloc?relay
   \   000014   8A..         MOV     ?V0 + 6,R2
   \   000016   8B..         MOV     ?V0 + 7,R3
   \   000018   AE..         MOV     R6,?V0 + 6
   \   00001A   AF..         MOV     R7,?V0 + 7
    170            if ( ep )
   \   00001C   EE           MOV     A,R6
   \   00001D   4F           ORL     A,R7
   \   00001E   7003         JNZ     $+5
   \   000020   02....       LJMP    ??afRegisterExtended_0 & 0xFFFF
    171            {
    172              // Fill in the new list entry
    173              ep->epDesc = epDesc;
   \   000023   8E82         MOV     DPL,R6
   \   000025   8F83         MOV     DPH,R7
   \   000027   E5..         MOV     A,?V0 + 0
   \   000029   F0           MOVX    @DPTR,A
   \   00002A   A3           INC     DPTR
   \   00002B   E5..         MOV     A,?V0 + 1
   \   00002D   F0           MOVX    @DPTR,A
    174              
    175              // Default to allow Match Descriptor.
    176              ep->flags = eEP_AllowMatch;
   \   00002E   8E82         MOV     DPL,R6
   \   000030   8F83         MOV     DPH,R7
   \   000032   A3           INC     DPTR
   \   000033   A3           INC     DPTR
   \   000034   7401         MOV     A,#0x1
   \   000036   F0           MOVX    @DPTR,A
    177              ep->pfnDescCB = descFn;
   \   000037   8E82         MOV     DPL,R6
   \   000039   8F83         MOV     DPH,R7
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   E5..         MOV     A,?V0 + 2
   \   000040   F0           MOVX    @DPTR,A
   \   000041   A3           INC     DPTR
   \   000042   E5..         MOV     A,?V0 + 3
   \   000044   F0           MOVX    @DPTR,A
    178              ep->nextDesc = NULL;
   \   000045   8E82         MOV     DPL,R6
   \   000047   8F83         MOV     DPH,R7
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   7400         MOV     A,#0x0
   \   000050   F0           MOVX    @DPTR,A
   \   000051   A3           INC     DPTR
   \   000052   7400         MOV     A,#0x0
   \   000054   F0           MOVX    @DPTR,A
    179          
    180              // Does a list exist?
    181              if ( epList == NULL )
   \   000055   90....       MOV     DPTR,#epList
   \   000058   E0           MOVX    A,@DPTR
   \   000059   F8           MOV     R0,A
   \   00005A   A3           INC     DPTR
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F9           MOV     R1,A
   \   00005D   E8           MOV     A,R0
   \   00005E   49           ORL     A,R1
   \   00005F   700A         JNZ     ??afRegisterExtended_1
    182                epList = ep;  // Make this the first entry
   \   000061   90....       MOV     DPTR,#epList
   \   000064   EE           MOV     A,R6
   \   000065   F0           MOVX    @DPTR,A
   \   000066   A3           INC     DPTR
   \   000067   EF           MOV     A,R7
   \   000068   F0           MOVX    @DPTR,A
   \   000069   8044         SJMP    ??afRegisterExtended_0
    183              else
    184              {
    185                // Look for the end of the list
    186                epSearch = epList;
   \                     ??afRegisterExtended_1:
   \   00006B   90....       MOV     DPTR,#epList
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F8           MOV     R0,A
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F9           MOV     R1,A
   \   000073   88..         MOV     ?V0 + 4,R0
   \   000075   89..         MOV     ?V0 + 5,R1
    187                while( epSearch->nextDesc != NULL )
   \                     ??afRegisterExtended_2:
   \   000077   85..82       MOV     DPL,?V0 + 4
   \   00007A   85..83       MOV     DPH,?V0 + 5
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   E0           MOVX    A,@DPTR
   \   000083   F8           MOV     R0,A
   \   000084   A3           INC     DPTR
   \   000085   E0           MOVX    A,@DPTR
   \   000086   F9           MOV     R1,A
   \   000087   E8           MOV     A,R0
   \   000088   49           ORL     A,R1
   \   000089   6014         JZ      ??afRegisterExtended_3
    188                  epSearch = epSearch->nextDesc;
   \   00008B   85..82       MOV     DPL,?V0 + 4
   \   00008E   85..83       MOV     DPH,?V0 + 5
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   E0           MOVX    A,@DPTR
   \   000097   F5..         MOV     ?V0 + 4,A
   \   000099   A3           INC     DPTR
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   F5..         MOV     ?V0 + 5,A
   \   00009D   80D8         SJMP    ??afRegisterExtended_2
    189          
    190                // Add new entry to end of list
    191                epSearch->nextDesc = ep;
   \                     ??afRegisterExtended_3:
   \   00009F   85..82       MOV     DPL,?V0 + 4
   \   0000A2   85..83       MOV     DPH,?V0 + 5
   \   0000A5   A3           INC     DPTR
   \   0000A6   A3           INC     DPTR
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   A3           INC     DPTR
   \   0000AA   EE           MOV     A,R6
   \   0000AB   F0           MOVX    @DPTR,A
   \   0000AC   A3           INC     DPTR
   \   0000AD   EF           MOV     A,R7
   \   0000AE   F0           MOVX    @DPTR,A
    192              }
    193            }
    194          
    195            return ep;
   \                     ??afRegisterExtended_0:
   \   0000AF   EE           MOV     A,R6
   \   0000B0   FA           MOV     R2,A
   \   0000B1   EF           MOV     A,R7
   \   0000B2   FB           MOV     R3,A
   \   0000B3   7F08         MOV     R7,#0x8
   \   0000B5   02....       LJMP    ?BANKED_LEAVE_XDATA
    196          }
    197          
    198          /*********************************************************************
    199           * @fn      afRegister
    200           *
    201           * @brief   Register an Application's EndPoint description.
    202           *
    203           * @param   epDesc - pointer to the Application's endpoint descriptor.
    204           *
    205           * NOTE:  The memory that epDesc is pointing to must exist after this call.
    206           *
    207           * @return  afStatus_SUCCESS - Registered
    208           *          afStatus_MEM_FAIL - not enough memory to add descriptor
    209           *          afStatus_INVALID_PARAMETER - duplicate endpoint
    210           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    211          afStatus_t afRegister( endPointDesc_t *epDesc )
   \                     afRegister:
    212          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    213            epList_t *ep;
    214            
    215            // Look for duplicate endpoint
    216            if ( afFindEndPointDescList( epDesc->endPoint ) )
   \   000009                ; Setup parameters for call to function afFindEndPointDescList
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   12....       LCALL   ??afFindEndPointDescList?relay
   \   000012   8A..         MOV     ?V0 + 2,R2
   \   000014   8B..         MOV     ?V0 + 3,R3
   \   000016   E5..         MOV     A,?V0 + 2
   \   000018   45..         ORL     A,?V0 + 3
   \   00001A   6004         JZ      ??afRegister_0
    217              return ( afStatus_INVALID_PARAMETER );
   \   00001C   7902         MOV     R1,#0x2
   \   00001E   8021         SJMP    ??afRegister_1
    218            
    219            ep = afRegisterExtended( epDesc, NULL );
   \                     ??afRegister_0:
   \   000020                ; Setup parameters for call to function afRegisterExtended
   \   000020   7C00         MOV     R4,#0x0
   \   000022   7D00         MOV     R5,#0x0
   \   000024   EE           MOV     A,R6
   \   000025   FA           MOV     R2,A
   \   000026   EF           MOV     A,R7
   \   000027   FB           MOV     R3,A
   \   000028   12....       LCALL   ??afRegisterExtended?relay
   \   00002B   8A..         MOV     ?V0 + 2,R2
   \   00002D   8B..         MOV     ?V0 + 3,R3
   \   00002F   85....       MOV     ?V0 + 0,?V0 + 2
   \   000032   85....       MOV     ?V0 + 1,?V0 + 3
    220          
    221            return ((ep == NULL) ? afStatus_MEM_FAIL : afStatus_SUCCESS);
   \   000035   E5..         MOV     A,?V0 + 0
   \   000037   45..         ORL     A,?V0 + 1
   \   000039   7004         JNZ     ??afRegister_2
   \   00003B   7910         MOV     R1,#0x10
   \   00003D   8002         SJMP    ??afRegister_1
   \                     ??afRegister_2:
   \   00003F   7900         MOV     R1,#0x0
   \                     ??afRegister_1:
   \   000041   7F04         MOV     R7,#0x4
   \   000043   02....       LJMP    ?BANKED_LEAVE_XDATA
    222          }
    223          
    224          
    225          /*********************************************************************
    226           * @fn          afDataConfirm
    227           *
    228           * @brief       This function will generate the Data Confirm back to
    229           *              the application.
    230           *
    231           * @param       endPoint - confirm end point
    232           * @param       transID - transaction ID from APSDE_DATA_REQUEST
    233           * @param       status - status of APSDE_DATA_REQUEST
    234           *
    235           * @return      none
    236           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    237          void afDataConfirm( uint8 endPoint, uint8 transID, ZStatus_t status )
   \                     afDataConfirm:
    238          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   8A..         MOV     ?V0 + 3,R2
   \   000009   8B..         MOV     ?V0 + 4,R3
    239            endPointDesc_t *epDesc;
    240            afDataConfirm_t *msgPtr;
    241          
    242            // Find the endpoint description
    243            epDesc = afFindEndPointDesc( endPoint );
   \   00000B                ; Setup parameters for call to function afFindEndPointDesc
   \   00000B   A9..         MOV     R1,?V0 + 2
   \   00000D   12....       LCALL   ??afFindEndPointDesc?relay
   \   000010   8A..         MOV     ?V0 + 6,R2
   \   000012   8B..         MOV     ?V0 + 7,R3
   \   000014   85....       MOV     ?V0 + 0,?V0 + 6
   \   000017   85....       MOV     ?V0 + 1,?V0 + 7
    244            if ( epDesc == NULL )
   \   00001A   E5..         MOV     A,?V0 + 0
   \   00001C   45..         ORL     A,?V0 + 1
   \   00001E   6054         JZ      ??afDataConfirm_0
    245              return;
    246          
    247            // Determine the incoming command type
    248            msgPtr = (afDataConfirm_t *)osal_msg_allocate( sizeof(afDataConfirm_t) );
   \   000020                ; Setup parameters for call to function osal_msg_allocate
   \   000020   7A04         MOV     R2,#0x4
   \   000022   7B00         MOV     R3,#0x0
   \   000024   12....       LCALL   ??osal_msg_allocate?relay
   \   000027   8A..         MOV     ?V0 + 6,R2
   \   000029   8B..         MOV     ?V0 + 7,R3
   \   00002B   AE..         MOV     R6,?V0 + 6
   \   00002D   AF..         MOV     R7,?V0 + 7
    249            if ( msgPtr )
   \   00002F   EE           MOV     A,R6
   \   000030   4F           ORL     A,R7
   \   000031   6041         JZ      ??afDataConfirm_0
    250            {
    251              // Build the Data Confirm message
    252              msgPtr->hdr.event = AF_DATA_CONFIRM_CMD;
   \   000033   8E82         MOV     DPL,R6
   \   000035   8F83         MOV     DPH,R7
   \   000037   74FD         MOV     A,#-0x3
   \   000039   F0           MOVX    @DPTR,A
    253              msgPtr->hdr.status = status;
   \   00003A   E5..         MOV     A,?V0 + 4
   \   00003C   8E82         MOV     DPL,R6
   \   00003E   8F83         MOV     DPH,R7
   \   000040   A3           INC     DPTR
   \   000041   E5..         MOV     A,?V0 + 4
   \   000043   F0           MOVX    @DPTR,A
    254              msgPtr->endpoint = endPoint;
   \   000044   E5..         MOV     A,?V0 + 2
   \   000046   8E82         MOV     DPL,R6
   \   000048   8F83         MOV     DPH,R7
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   E5..         MOV     A,?V0 + 2
   \   00004E   F0           MOVX    @DPTR,A
    255              msgPtr->transID = transID;
   \   00004F   E5..         MOV     A,?V0 + 3
   \   000051   8E82         MOV     DPL,R6
   \   000053   8F83         MOV     DPH,R7
   \   000055   A3           INC     DPTR
   \   000056   A3           INC     DPTR
   \   000057   A3           INC     DPTR
   \   000058   E5..         MOV     A,?V0 + 3
   \   00005A   F0           MOVX    @DPTR,A
    256          
    257          #if defined ( MT_AF_CB_FUNC )
    258              /* If MT has subscribed for this callback, don't send as a message. */
    259              if ( AFCB_CHECK(CB_ID_AF_DATA_CNF,*(epDesc->task_id)) )
    260              {
    261                /* Send callback if it's subscribed */
    262                MT_AfDataConfirm ((void *)msgPtr);
    263                /* Release the memory. */
    264                osal_msg_deallocate( (void *)msgPtr );
    265              }
    266              else
    267          #endif
    268              {
    269                /* send message through task message */
    270                osal_msg_send( *(epDesc->task_id), (byte *)msgPtr );
   \   00005B                ; Setup parameters for call to function osal_msg_send
   \   00005B   EE           MOV     A,R6
   \   00005C   FA           MOV     R2,A
   \   00005D   EF           MOV     A,R7
   \   00005E   FB           MOV     R3,A
   \   00005F   85..82       MOV     DPL,?V0 + 0
   \   000062   85..83       MOV     DPH,?V0 + 1
   \   000065   A3           INC     DPTR
   \   000066   E0           MOVX    A,@DPTR
   \   000067   F8           MOV     R0,A
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F583         MOV     DPH,A
   \   00006C   8882         MOV     DPL,R0
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F9           MOV     R1,A
   \   000070   12....       LCALL   ??osal_msg_send?relay
   \   000073   E9           MOV     A,R1
    271              }
    272            }
    273          }
   \                     ??afDataConfirm_0:
   \   000074   7F08         MOV     R7,#0x8
   \   000076   02....       LJMP    ?BANKED_LEAVE_XDATA
    274          
    275          /*********************************************************************
    276           * @fn          afIncomingData
    277           *
    278           * @brief       Transfer a data PDU (ASDU) from the APS sub-layer to the AF.
    279           *
    280           * @param       aff  - pointer to APS frame format
    281           * @param       SrcAddress  - Source address
    282           * @param       sig - incoming message's link quality
    283           * @param       SecurityUse - Security enable/disable
    284           *
    285           * @return      none
    286           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    287          void afIncomingData( aps_FrameFormat_t *aff, zAddrType_t *SrcAddress, uint16 SrcPanId,
   \                     afIncomingData:
    288                               NLDE_Signal_t *sig, byte SecurityUse, uint32 timestamp )
    289          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7402         MOV     A,#0x2
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EC           MOV     A,R4
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   ED           MOV     A,R5
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8A..         MOV     ?V0 + 8,R2
   \   000016   8B..         MOV     ?V0 + 9,R3
   \   000018   89..         MOV     ?V0 + 3,R1
   \   00001A   741C         MOV     A,#0x1c
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 10,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F5..         MOV     ?V0 + 11,A
   \   000026   7420         MOV     A,#0x20
   \   000028   12....       LCALL   ?XSTACK_DISP0_8
   \   00002B   78..         MOV     R0,#?V0 + 4
   \   00002D   12....       LCALL   ?L_MOV_X
    290            endPointDesc_t *epDesc = NULL;
   \   000030   7E00         MOV     R6,#0x0
   \   000032   7F00         MOV     R7,#0x0
    291            uint16 epProfileID = 0xFFFF;  // Invalid Profile ID
   \   000034   85..82       MOV     DPL,?XSP + 0
   \   000037   85..83       MOV     DPH,?XSP + 1
   \   00003A   74FF         MOV     A,#-0x1
   \   00003C   F0           MOVX    @DPTR,A
   \   00003D   A3           INC     DPTR
   \   00003E   74FF         MOV     A,#-0x1
   \   000040   F0           MOVX    @DPTR,A
    292            epList_t *pList = epList;
   \   000041   90....       MOV     DPTR,#epList
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F5..         MOV     ?V0 + 0,A
   \   000047   A3           INC     DPTR
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F5..         MOV     ?V0 + 1,A
    293          #if !defined ( APS_NO_GROUPS )    
    294            uint8 grpEp = APS_GROUPS_EP_NOT_FOUND;
   \   00004B   75..FE       MOV     ?V0 + 2,#-0x2
    295          #endif  
    296          
    297            if ( ((aff->FrmCtrl & APS_DELIVERYMODE_MASK) == APS_FC_DM_GROUP) )
   \   00004E   85..82       MOV     DPL,?V0 + 8
   \   000051   85..83       MOV     DPH,?V0 + 9
   \   000054   E0           MOVX    A,@DPTR
   \   000055   540C         ANL     A,#0xc
   \   000057   640C         XRL     A,#0xc
   \   000059   7049         JNZ     ??afIncomingData_0
    298            {
    299          #if !defined ( APS_NO_GROUPS )    
    300              // Find the first endpoint for this group
    301              grpEp = aps_FindGroupForEndpoint( aff->GroupID, APS_GROUPS_FIND_FIRST );
   \   00005B                ; Setup parameters for call to function aps_FindGroupForEndpoint
   \   00005B   79FE         MOV     R1,#-0x2
   \   00005D   85..82       MOV     DPL,?V0 + 8
   \   000060   85..83       MOV     DPH,?V0 + 9
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   E0           MOVX    A,@DPTR
   \   000068   FA           MOV     R2,A
   \   000069   A3           INC     DPTR
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   FB           MOV     R3,A
   \   00006C   12....       LCALL   ??aps_FindGroupForEndpoint?relay
   \   00006F   E9           MOV     A,R1
   \   000070   F5..         MOV     ?V0 + 2,A
    302              if ( grpEp == APS_GROUPS_EP_NOT_FOUND )
   \   000072   74FE         MOV     A,#-0x2
   \   000074   65..         XRL     A,?V0 + 2
   \   000076   7003         JNZ     $+5
   \   000078   02....       LJMP    ??afIncomingData_1 & 0xFFFF
    303                return;   // No endpoint found
    304          
    305              epDesc = afFindEndPointDesc( grpEp );
   \   00007B                ; Setup parameters for call to function afFindEndPointDesc
   \   00007B   A9..         MOV     R1,?V0 + 2
   \   00007D   12....       LCALL   ??afFindEndPointDesc?relay
   \   000080   8A..         MOV     ?V0 + 12,R2
   \   000082   8B..         MOV     ?V0 + 13,R3
   \   000084   AE..         MOV     R6,?V0 + 12
   \   000086   AF..         MOV     R7,?V0 + 13
    306              if ( epDesc == NULL )
   \   000088   EE           MOV     A,R6
   \   000089   4F           ORL     A,R7
   \   00008A   7003         JNZ     $+5
   \   00008C   02....       LJMP    ??afIncomingData_1 & 0xFFFF
    307                return;   // Endpoint descriptor not found
    308          
    309              pList = afFindEndPointDescList( epDesc->endPoint );
   \   00008F                ; Setup parameters for call to function afFindEndPointDescList
   \   00008F   8E82         MOV     DPL,R6
   \   000091   8F83         MOV     DPH,R7
   \   000093   E0           MOVX    A,@DPTR
   \   000094   F9           MOV     R1,A
   \   000095   12....       LCALL   ??afFindEndPointDescList?relay
   \   000098   8A..         MOV     ?V0 + 12,R2
   \   00009A   8B..         MOV     ?V0 + 13,R3
   \   00009C   85....       MOV     ?V0 + 0,?V0 + 12
   \   00009F   85....       MOV     ?V0 + 1,?V0 + 13
   \   0000A2   8054         SJMP    ??afIncomingData_2
    310          #else
    311              return; // Not supported
    312          #endif    
    313            }
    314            else if ( aff->DstEndPoint == AF_BROADCAST_ENDPOINT )
   \                     ??afIncomingData_0:
   \   0000A4   85..82       MOV     DPL,?V0 + 8
   \   0000A7   85..83       MOV     DPH,?V0 + 9
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   64FF         XRL     A,#0xff
   \   0000AF   7017         JNZ     ??afIncomingData_3
    315            {
    316              // Set the list
    317              if ( pList != NULL )
   \   0000B1   E5..         MOV     A,?V0 + 0
   \   0000B3   45..         ORL     A,?V0 + 1
   \   0000B5   6041         JZ      ??afIncomingData_2
    318              {
    319                epDesc = pList->epDesc;
   \   0000B7   85..82       MOV     DPL,?V0 + 0
   \   0000BA   85..83       MOV     DPH,?V0 + 1
   \   0000BD   E0           MOVX    A,@DPTR
   \   0000BE   F8           MOV     R0,A
   \   0000BF   A3           INC     DPTR
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   F9           MOV     R1,A
   \   0000C2   E8           MOV     A,R0
   \   0000C3   FE           MOV     R6,A
   \   0000C4   E9           MOV     A,R1
   \   0000C5   FF           MOV     R7,A
   \   0000C6   8030         SJMP    ??afIncomingData_2
    320              }
    321            }
    322            else if ( (epDesc = afFindEndPointDesc( aff->DstEndPoint )) )
   \                     ??afIncomingData_3:
   \   0000C8                ; Setup parameters for call to function afFindEndPointDesc
   \   0000C8   85..82       MOV     DPL,?V0 + 8
   \   0000CB   85..83       MOV     DPH,?V0 + 9
   \   0000CE   A3           INC     DPTR
   \   0000CF   A3           INC     DPTR
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   F9           MOV     R1,A
   \   0000D2   12....       LCALL   ??afFindEndPointDesc?relay
   \   0000D5   8A..         MOV     ?V0 + 12,R2
   \   0000D7   8B..         MOV     ?V0 + 13,R3
   \   0000D9   A8..         MOV     R0,?V0 + 12
   \   0000DB   A9..         MOV     R1,?V0 + 13
   \   0000DD   E8           MOV     A,R0
   \   0000DE   FE           MOV     R6,A
   \   0000DF   E9           MOV     A,R1
   \   0000E0   FF           MOV     R7,A
   \   0000E1   E8           MOV     A,R0
   \   0000E2   49           ORL     A,R1
   \   0000E3   6013         JZ      ??afIncomingData_2
    323            {
    324              pList = afFindEndPointDescList( epDesc->endPoint );
   \   0000E5                ; Setup parameters for call to function afFindEndPointDescList
   \   0000E5   8E82         MOV     DPL,R6
   \   0000E7   8F83         MOV     DPH,R7
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   F9           MOV     R1,A
   \   0000EB   12....       LCALL   ??afFindEndPointDescList?relay
   \   0000EE   8A..         MOV     ?V0 + 12,R2
   \   0000F0   8B..         MOV     ?V0 + 13,R3
   \   0000F2   85....       MOV     ?V0 + 0,?V0 + 12
   \   0000F5   85....       MOV     ?V0 + 1,?V0 + 13
    325            }
    326          
    327            while ( epDesc )
   \                     ??afIncomingData_2:
   \   0000F8   EE           MOV     A,R6
   \   0000F9   4F           ORL     A,R7
   \   0000FA   7003         JNZ     $+5
   \   0000FC   02....       LJMP    ??afIncomingData_1 & 0xFFFF
    328            {
    329              if ( pList->pfnDescCB )
   \   0000FF   85..82       MOV     DPL,?V0 + 0
   \   000102   85..83       MOV     DPH,?V0 + 1
   \   000105   A3           INC     DPTR
   \   000106   A3           INC     DPTR
   \   000107   A3           INC     DPTR
   \   000108   E0           MOVX    A,@DPTR
   \   000109   F8           MOV     R0,A
   \   00010A   A3           INC     DPTR
   \   00010B   E0           MOVX    A,@DPTR
   \   00010C   F9           MOV     R1,A
   \   00010D   E8           MOV     A,R0
   \   00010E   49           ORL     A,R1
   \   00010F   604B         JZ      ??afIncomingData_4
    330              {
    331                uint16 *pID = (uint16 *)(pList->pfnDescCB(
    332                                           AF_DESCRIPTOR_PROFILE_ID, epDesc->endPoint ));
   \   000111                ; Setup parameters for indirect call
   \   000111   8E82         MOV     DPL,R6
   \   000113   8F83         MOV     DPH,R7
   \   000115   E0           MOVX    A,@DPTR
   \   000116   FA           MOV     R2,A
   \   000117   7902         MOV     R1,#0x2
   \   000119   85..82       MOV     DPL,?V0 + 0
   \   00011C   85..83       MOV     DPH,?V0 + 1
   \   00011F   A3           INC     DPTR
   \   000120   A3           INC     DPTR
   \   000121   A3           INC     DPTR
   \   000122   E0           MOVX    A,@DPTR
   \   000123   F8           MOV     R0,A
   \   000124   A3           INC     DPTR
   \   000125   E0           MOVX    A,@DPTR
   \   000126   F583         MOV     DPH,A
   \   000128   8882         MOV     DPL,R0
   \   00012A   12....       LCALL   ?CALL_IND
   \   00012D   8A..         MOV     ?V0 + 12,R2
   \   00012F   8B..         MOV     ?V0 + 13,R3
   \   000131   85....       MOV     ?V0 + 14,?V0 + 12
   \   000134   85....       MOV     ?V0 + 15,?V0 + 13
    333                if ( pID )
   \   000137   E5..         MOV     A,?V0 + 14
   \   000139   45..         ORL     A,?V0 + 15
   \   00013B   604F         JZ      ??afIncomingData_5
    334                {
    335                  epProfileID = *pID;
   \   00013D   85..82       MOV     DPL,?V0 + 14
   \   000140   85..83       MOV     DPH,?V0 + 15
   \   000143   E0           MOVX    A,@DPTR
   \   000144   F8           MOV     R0,A
   \   000145   A3           INC     DPTR
   \   000146   E0           MOVX    A,@DPTR
   \   000147   F9           MOV     R1,A
   \   000148   85..82       MOV     DPL,?XSP + 0
   \   00014B   85..83       MOV     DPH,?XSP + 1
   \   00014E   E8           MOV     A,R0
   \   00014F   F0           MOVX    @DPTR,A
   \   000150   A3           INC     DPTR
   \   000151   E9           MOV     A,R1
   \   000152   F0           MOVX    @DPTR,A
    336                  osal_mem_free( pID );
   \   000153                ; Setup parameters for call to function osal_mem_free
   \   000153   AA..         MOV     R2,?V0 + 14
   \   000155   AB..         MOV     R3,?V0 + 15
   \   000157   12....       LCALL   ??osal_mem_free?relay
   \   00015A   8030         SJMP    ??afIncomingData_5
    337                }
    338              }
    339              else if ( epDesc->simpleDesc )
   \                     ??afIncomingData_4:
   \   00015C   8E82         MOV     DPL,R6
   \   00015E   8F83         MOV     DPH,R7
   \   000160   A3           INC     DPTR
   \   000161   A3           INC     DPTR
   \   000162   A3           INC     DPTR
   \   000163   E0           MOVX    A,@DPTR
   \   000164   F8           MOV     R0,A
   \   000165   A3           INC     DPTR
   \   000166   E0           MOVX    A,@DPTR
   \   000167   F9           MOV     R1,A
   \   000168   E8           MOV     A,R0
   \   000169   49           ORL     A,R1
   \   00016A   6020         JZ      ??afIncomingData_5
    340              {
    341                epProfileID = epDesc->simpleDesc->AppProfId;
   \   00016C   8E82         MOV     DPL,R6
   \   00016E   8F83         MOV     DPH,R7
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   E0           MOVX    A,@DPTR
   \   000174   F8           MOV     R0,A
   \   000175   A3           INC     DPTR
   \   000176   E0           MOVX    A,@DPTR
   \   000177   F583         MOV     DPH,A
   \   000179   8882         MOV     DPL,R0
   \   00017B   A3           INC     DPTR
   \   00017C   E0           MOVX    A,@DPTR
   \   00017D   F8           MOV     R0,A
   \   00017E   A3           INC     DPTR
   \   00017F   E0           MOVX    A,@DPTR
   \   000180   F9           MOV     R1,A
   \   000181   85..82       MOV     DPL,?XSP + 0
   \   000184   85..83       MOV     DPH,?XSP + 1
   \   000187   E8           MOV     A,R0
   \   000188   F0           MOVX    @DPTR,A
   \   000189   A3           INC     DPTR
   \   00018A   E9           MOV     A,R1
   \   00018B   F0           MOVX    @DPTR,A
    342              }
    343          
    344              if ( (aff->ProfileID == epProfileID) ||
    345                   ((epDesc->endPoint == ZDO_EP) && (aff->ProfileID == ZDO_PROFILE_ID)) )
   \                     ??afIncomingData_5:
   \   00018C   85..82       MOV     DPL,?V0 + 8
   \   00018F   85..83       MOV     DPH,?V0 + 9
   \   000192   A3           INC     DPTR
   \   000193   A3           INC     DPTR
   \   000194   A3           INC     DPTR
   \   000195   A3           INC     DPTR
   \   000196   A3           INC     DPTR
   \   000197   A3           INC     DPTR
   \   000198   A3           INC     DPTR
   \   000199   A3           INC     DPTR
   \   00019A   E0           MOVX    A,@DPTR
   \   00019B   F8           MOV     R0,A
   \   00019C   A3           INC     DPTR
   \   00019D   E0           MOVX    A,@DPTR
   \   00019E   F9           MOV     R1,A
   \   00019F   85..82       MOV     DPL,?XSP + 0
   \   0001A2   85..83       MOV     DPH,?XSP + 1
   \   0001A5   E0           MOVX    A,@DPTR
   \   0001A6   68           XRL     A,R0
   \   0001A7   7003         JNZ     ??afIncomingData_6
   \   0001A9   A3           INC     DPTR
   \   0001AA   E0           MOVX    A,@DPTR
   \   0001AB   69           XRL     A,R1
   \                     ??afIncomingData_6:
   \   0001AC   601E         JZ      ??afIncomingData_7
   \   0001AE   8E82         MOV     DPL,R6
   \   0001B0   8F83         MOV     DPH,R7
   \   0001B2   E0           MOVX    A,@DPTR
   \   0001B3   7043         JNZ     ??afIncomingData_8
   \   0001B5   85..82       MOV     DPL,?V0 + 8
   \   0001B8   85..83       MOV     DPH,?V0 + 9
   \   0001BB   A3           INC     DPTR
   \   0001BC   A3           INC     DPTR
   \   0001BD   A3           INC     DPTR
   \   0001BE   A3           INC     DPTR
   \   0001BF   A3           INC     DPTR
   \   0001C0   A3           INC     DPTR
   \   0001C1   A3           INC     DPTR
   \   0001C2   A3           INC     DPTR
   \   0001C3   E0           MOVX    A,@DPTR
   \   0001C4   F8           MOV     R0,A
   \   0001C5   A3           INC     DPTR
   \   0001C6   E0           MOVX    A,@DPTR
   \   0001C7   F9           MOV     R1,A
   \   0001C8   E8           MOV     A,R0
   \   0001C9   49           ORL     A,R1
   \   0001CA   702C         JNZ     ??afIncomingData_8
    346              {
    347                {
    348                  afBuildMSGIncoming( aff, epDesc, SrcAddress, SrcPanId, sig, SecurityUse, timestamp );
   \                     ??afIncomingData_7:
   \   0001CC                ; Setup parameters for call to function afBuildMSGIncoming
   \   0001CC   78..         MOV     R0,#?V0 + 4
   \   0001CE   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   0001D1   7422         MOV     A,#0x22
   \   0001D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0001D6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0001D9   78..         MOV     R0,#?V0 + 10
   \   0001DB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001DE   740A         MOV     A,#0xa
   \   0001E0   12....       LCALL   ?XSTACK_DISP0_8
   \   0001E3   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0001E6   A9..         MOV     R1,?V0 + 3
   \   0001E8   EE           MOV     A,R6
   \   0001E9   FC           MOV     R4,A
   \   0001EA   EF           MOV     A,R7
   \   0001EB   FD           MOV     R5,A
   \   0001EC   AA..         MOV     R2,?V0 + 8
   \   0001EE   AB..         MOV     R3,?V0 + 9
   \   0001F0   12....       LCALL   ??afBuildMSGIncoming?relay
   \   0001F3   740A         MOV     A,#0xa
   \   0001F5   12....       LCALL   ?DEALLOC_XSTACK8
    349                }
    350              }
    351          
    352              if ( ((aff->FrmCtrl & APS_DELIVERYMODE_MASK) == APS_FC_DM_GROUP) )
   \                     ??afIncomingData_8:
   \   0001F8   85..82       MOV     DPL,?V0 + 8
   \   0001FB   85..83       MOV     DPH,?V0 + 9
   \   0001FE   E0           MOVX    A,@DPTR
   \   0001FF   540C         ANL     A,#0xc
   \   000201   640C         XRL     A,#0xc
   \   000203   7044         JNZ     ??afIncomingData_9
    353              {
    354          #if !defined ( APS_NO_GROUPS )      
    355                // Find the next endpoint for this group
    356                grpEp = aps_FindGroupForEndpoint( aff->GroupID, grpEp );
   \   000205                ; Setup parameters for call to function aps_FindGroupForEndpoint
   \   000205   A9..         MOV     R1,?V0 + 2
   \   000207   85..82       MOV     DPL,?V0 + 8
   \   00020A   85..83       MOV     DPH,?V0 + 9
   \   00020D   A3           INC     DPTR
   \   00020E   A3           INC     DPTR
   \   00020F   A3           INC     DPTR
   \   000210   A3           INC     DPTR
   \   000211   E0           MOVX    A,@DPTR
   \   000212   FA           MOV     R2,A
   \   000213   A3           INC     DPTR
   \   000214   E0           MOVX    A,@DPTR
   \   000215   FB           MOV     R3,A
   \   000216   12....       LCALL   ??aps_FindGroupForEndpoint?relay
   \   000219   E9           MOV     A,R1
   \   00021A   F5..         MOV     ?V0 + 2,A
    357                if ( grpEp == APS_GROUPS_EP_NOT_FOUND )
   \   00021C   74FE         MOV     A,#-0x2
   \   00021E   65..         XRL     A,?V0 + 2
   \   000220   606C         JZ      ??afIncomingData_1
    358                  return;   // No endpoint found
    359          
    360                epDesc = afFindEndPointDesc( grpEp );
   \   000222                ; Setup parameters for call to function afFindEndPointDesc
   \   000222   A9..         MOV     R1,?V0 + 2
   \   000224   12....       LCALL   ??afFindEndPointDesc?relay
   \   000227   8A..         MOV     ?V0 + 12,R2
   \   000229   8B..         MOV     ?V0 + 13,R3
   \   00022B   AE..         MOV     R6,?V0 + 12
   \   00022D   AF..         MOV     R7,?V0 + 13
    361                if ( epDesc == NULL )
   \   00022F   EE           MOV     A,R6
   \   000230   4F           ORL     A,R7
   \   000231   605B         JZ      ??afIncomingData_1
    362                  return;   // Endpoint descriptor not found
    363          
    364                pList = afFindEndPointDescList( epDesc->endPoint );
   \   000233                ; Setup parameters for call to function afFindEndPointDescList
   \   000233   8E82         MOV     DPL,R6
   \   000235   8F83         MOV     DPH,R7
   \   000237   E0           MOVX    A,@DPTR
   \   000238   F9           MOV     R1,A
   \   000239   12....       LCALL   ??afFindEndPointDescList?relay
   \   00023C   8A..         MOV     ?V0 + 12,R2
   \   00023E   8B..         MOV     ?V0 + 13,R3
   \   000240   85....       MOV     ?V0 + 0,?V0 + 12
   \   000243   85....       MOV     ?V0 + 1,?V0 + 13
   \   000246   02....       LJMP    ??afIncomingData_2 & 0xFFFF
    365          #else
    366                return;
    367          #endif      
    368              }
    369              else if ( aff->DstEndPoint == AF_BROADCAST_ENDPOINT )
   \                     ??afIncomingData_9:
   \   000249   85..82       MOV     DPL,?V0 + 8
   \   00024C   85..83       MOV     DPH,?V0 + 9
   \   00024F   A3           INC     DPTR
   \   000250   A3           INC     DPTR
   \   000251   E0           MOVX    A,@DPTR
   \   000252   64FF         XRL     A,#0xff
   \   000254   7031         JNZ     ??afIncomingData_10
    370              {
    371                pList = pList->nextDesc;
   \   000256   85..82       MOV     DPL,?V0 + 0
   \   000259   85..83       MOV     DPH,?V0 + 1
   \   00025C   A3           INC     DPTR
   \   00025D   A3           INC     DPTR
   \   00025E   A3           INC     DPTR
   \   00025F   A3           INC     DPTR
   \   000260   A3           INC     DPTR
   \   000261   E0           MOVX    A,@DPTR
   \   000262   F5..         MOV     ?V0 + 0,A
   \   000264   A3           INC     DPTR
   \   000265   E0           MOVX    A,@DPTR
   \   000266   F5..         MOV     ?V0 + 1,A
    372                if ( pList )
   \   000268   E5..         MOV     A,?V0 + 0
   \   00026A   45..         ORL     A,?V0 + 1
   \   00026C   6012         JZ      ??afIncomingData_11
    373                  epDesc = pList->epDesc;
   \   00026E   85..82       MOV     DPL,?V0 + 0
   \   000271   85..83       MOV     DPH,?V0 + 1
   \   000274   E0           MOVX    A,@DPTR
   \   000275   F8           MOV     R0,A
   \   000276   A3           INC     DPTR
   \   000277   E0           MOVX    A,@DPTR
   \   000278   F9           MOV     R1,A
   \   000279   E8           MOV     A,R0
   \   00027A   FE           MOV     R6,A
   \   00027B   E9           MOV     A,R1
   \   00027C   FF           MOV     R7,A
   \   00027D   02....       LJMP    ??afIncomingData_2 & 0xFFFF
    374                else
    375                  epDesc = NULL;
   \                     ??afIncomingData_11:
   \   000280   7E00         MOV     R6,#0x0
   \   000282   7F00         MOV     R7,#0x0
   \   000284   02....       LJMP    ??afIncomingData_2 & 0xFFFF
    376              }
    377              else
    378                epDesc = NULL;
   \                     ??afIncomingData_10:
   \   000287   7E00         MOV     R6,#0x0
   \   000289   7F00         MOV     R7,#0x0
   \   00028B   02....       LJMP    ??afIncomingData_2 & 0xFFFF
    379            }
    380          }
   \                     ??afIncomingData_1:
   \   00028E   7404         MOV     A,#0x4
   \   000290   12....       LCALL   ?DEALLOC_XSTACK8
   \   000293   7F10         MOV     R7,#0x10
   \   000295   02....       LJMP    ?BANKED_LEAVE_XDATA
    381          
    382          /*********************************************************************
    383           * @fn          afBuildMSGIncoming
    384           *
    385           * @brief       Build the message for the app
    386           *
    387           * @param
    388           *
    389           * @return      pointer to next in data buffer
    390           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    391          static void afBuildMSGIncoming( aps_FrameFormat_t *aff, endPointDesc_t *epDesc,
   \                     afBuildMSGIncoming:
    392                           zAddrType_t *SrcAddress, uint16 SrcPanId, NLDE_Signal_t *sig, 
    393                           byte SecurityUse, uint32 timestamp )
    394          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 0,R2
   \   000014   8B..         MOV     ?V0 + 1,R3
   \   000016   8C..         MOV     ?V0 + 12,R4
   \   000018   8D..         MOV     ?V0 + 13,R5
   \   00001A   741D         MOV     A,#0x1d
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 2,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F5..         MOV     ?V0 + 3,A
   \   000026   741F         MOV     A,#0x1f
   \   000028   12....       LCALL   ?XSTACK_DISP0_8
   \   00002B   78..         MOV     R0,#?V0 + 4
   \   00002D   12....       LCALL   ?L_MOV_X
    395            afIncomingMSGPacket_t *MSGpkt;
    396            const byte len = sizeof( afIncomingMSGPacket_t ) + aff->asduLength;
   \   000030   E5..         MOV     A,?V0 + 0
   \   000032   2410         ADD     A,#0x10
   \   000034   F582         MOV     DPL,A
   \   000036   E5..         MOV     A,?V0 + 1
   \   000038   3400         ADDC    A,#0x0
   \   00003A   F583         MOV     DPH,A
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   2423         ADD     A,#0x23
   \   00003F   F5..         MOV     ?V0 + 11,A
    397            byte *asdu = aff->asdu;
   \   000041   E5..         MOV     A,?V0 + 0
   \   000043   240E         ADD     A,#0xe
   \   000045   F582         MOV     DPL,A
   \   000047   E5..         MOV     A,?V0 + 1
   \   000049   3400         ADDC    A,#0x0
   \   00004B   F583         MOV     DPH,A
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F5..         MOV     ?V0 + 14,A
   \   000050   A3           INC     DPTR
   \   000051   E0           MOVX    A,@DPTR
   \   000052   F5..         MOV     ?V0 + 15,A
    398            MSGpkt = (afIncomingMSGPacket_t *)osal_msg_allocate( len );
   \   000054                ; Setup parameters for call to function osal_msg_allocate
   \   000054   85....       MOV     ?V0 + 8,?V0 + 11
   \   000057   75..00       MOV     ?V0 + 9,#0x0
   \   00005A   AA..         MOV     R2,?V0 + 8
   \   00005C   AB..         MOV     R3,?V0 + 9
   \   00005E   12....       LCALL   ??osal_msg_allocate?relay
   \   000061   8A..         MOV     ?V0 + 8,R2
   \   000063   8B..         MOV     ?V0 + 9,R3
   \   000065   AE..         MOV     R6,?V0 + 8
   \   000067   AF..         MOV     R7,?V0 + 9
    399          
    400            if ( MSGpkt == NULL )
   \   000069   EE           MOV     A,R6
   \   00006A   4F           ORL     A,R7
   \   00006B   7003         JNZ     $+5
   \   00006D   02....       LJMP    ??afBuildMSGIncoming_0 & 0xFFFF
    401            {
    402              return;
    403            }
    404          
    405            MSGpkt->hdr.event = AF_INCOMING_MSG_CMD;
   \   000070   8E82         MOV     DPL,R6
   \   000072   8F83         MOV     DPH,R7
   \   000074   741A         MOV     A,#0x1a
   \   000076   F0           MOVX    @DPTR,A
    406            MSGpkt->groupId = aff->GroupID;
   \   000077   85..82       MOV     DPL,?V0 + 0
   \   00007A   85..83       MOV     DPH,?V0 + 1
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   E0           MOVX    A,@DPTR
   \   000082   F8           MOV     R0,A
   \   000083   A3           INC     DPTR
   \   000084   E0           MOVX    A,@DPTR
   \   000085   F9           MOV     R1,A
   \   000086   8E82         MOV     DPL,R6
   \   000088   8F83         MOV     DPH,R7
   \   00008A   A3           INC     DPTR
   \   00008B   A3           INC     DPTR
   \   00008C   E8           MOV     A,R0
   \   00008D   F0           MOVX    @DPTR,A
   \   00008E   A3           INC     DPTR
   \   00008F   E9           MOV     A,R1
   \   000090   F0           MOVX    @DPTR,A
    407            MSGpkt->clusterId = aff->ClusterID;
   \   000091   85..82       MOV     DPL,?V0 + 0
   \   000094   85..83       MOV     DPH,?V0 + 1
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   A3           INC     DPTR
   \   00009A   A3           INC     DPTR
   \   00009B   A3           INC     DPTR
   \   00009C   A3           INC     DPTR
   \   00009D   E0           MOVX    A,@DPTR
   \   00009E   F8           MOV     R0,A
   \   00009F   A3           INC     DPTR
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   F9           MOV     R1,A
   \   0000A2   8E82         MOV     DPL,R6
   \   0000A4   8F83         MOV     DPH,R7
   \   0000A6   A3           INC     DPTR
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   A3           INC     DPTR
   \   0000AA   E8           MOV     A,R0
   \   0000AB   F0           MOVX    @DPTR,A
   \   0000AC   A3           INC     DPTR
   \   0000AD   E9           MOV     A,R1
   \   0000AE   F0           MOVX    @DPTR,A
    408            afCopyAddress( &MSGpkt->srcAddr, SrcAddress );
   \   0000AF                ; Setup parameters for call to function afCopyAddress
   \   0000AF   7419         MOV     A,#0x19
   \   0000B1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   FC           MOV     R4,A
   \   0000B6   A3           INC     DPTR
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   FD           MOV     R5,A
   \   0000B9   EE           MOV     A,R6
   \   0000BA   2406         ADD     A,#0x6
   \   0000BC   FA           MOV     R2,A
   \   0000BD   EF           MOV     A,R7
   \   0000BE   3400         ADDC    A,#0x0
   \   0000C0   FB           MOV     R3,A
   \   0000C1   12....       LCALL   ??afCopyAddress?relay
    409            MSGpkt->srcAddr.endPoint = aff->SrcEndPoint;
   \   0000C4   85..82       MOV     DPL,?V0 + 0
   \   0000C7   85..83       MOV     DPH,?V0 + 1
   \   0000CA   A3           INC     DPTR
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   E0           MOVX    A,@DPTR
   \   0000CE   C0E0         PUSH    A
   \   0000D0   EE           MOV     A,R6
   \   0000D1   240F         ADD     A,#0xf
   \   0000D3   F582         MOV     DPL,A
   \   0000D5   EF           MOV     A,R7
   \   0000D6   3400         ADDC    A,#0x0
   \   0000D8   F583         MOV     DPH,A
   \   0000DA   D0E0         POP     A
   \   0000DC   F0           MOVX    @DPTR,A
    410            MSGpkt->endPoint = epDesc->endPoint;
   \   0000DD   85..82       MOV     DPL,?V0 + 12
   \   0000E0   85..83       MOV     DPH,?V0 + 13
   \   0000E3   E0           MOVX    A,@DPTR
   \   0000E4   C0E0         PUSH    A
   \   0000E6   EE           MOV     A,R6
   \   0000E7   2414         ADD     A,#0x14
   \   0000E9   F582         MOV     DPL,A
   \   0000EB   EF           MOV     A,R7
   \   0000EC   3400         ADDC    A,#0x0
   \   0000EE   F583         MOV     DPH,A
   \   0000F0   D0E0         POP     A
   \   0000F2   F0           MOVX    @DPTR,A
    411            MSGpkt->wasBroadcast = aff->wasBroadcast;
   \   0000F3   E5..         MOV     A,?V0 + 0
   \   0000F5   240C         ADD     A,#0xc
   \   0000F7   F582         MOV     DPL,A
   \   0000F9   E5..         MOV     A,?V0 + 1
   \   0000FB   3400         ADDC    A,#0x0
   \   0000FD   F583         MOV     DPH,A
   \   0000FF   E0           MOVX    A,@DPTR
   \   000100   C0E0         PUSH    A
   \   000102   EE           MOV     A,R6
   \   000103   2415         ADD     A,#0x15
   \   000105   F582         MOV     DPL,A
   \   000107   EF           MOV     A,R7
   \   000108   3400         ADDC    A,#0x0
   \   00010A   F583         MOV     DPH,A
   \   00010C   D0E0         POP     A
   \   00010E   F0           MOVX    @DPTR,A
    412            MSGpkt->LinkQuality = sig->LinkQuality;
   \   00010F   85..82       MOV     DPL,?V0 + 2
   \   000112   85..83       MOV     DPH,?V0 + 3
   \   000115   E0           MOVX    A,@DPTR
   \   000116   C0E0         PUSH    A
   \   000118   EE           MOV     A,R6
   \   000119   2416         ADD     A,#0x16
   \   00011B   F582         MOV     DPL,A
   \   00011D   EF           MOV     A,R7
   \   00011E   3400         ADDC    A,#0x0
   \   000120   F583         MOV     DPH,A
   \   000122   D0E0         POP     A
   \   000124   F0           MOVX    @DPTR,A
    413            MSGpkt->correlation = sig->correlation;
   \   000125   85..82       MOV     DPL,?V0 + 2
   \   000128   85..83       MOV     DPH,?V0 + 3
   \   00012B   A3           INC     DPTR
   \   00012C   E0           MOVX    A,@DPTR
   \   00012D   C0E0         PUSH    A
   \   00012F   EE           MOV     A,R6
   \   000130   2417         ADD     A,#0x17
   \   000132   F582         MOV     DPL,A
   \   000134   EF           MOV     A,R7
   \   000135   3400         ADDC    A,#0x0
   \   000137   F583         MOV     DPH,A
   \   000139   D0E0         POP     A
   \   00013B   F0           MOVX    @DPTR,A
    414            MSGpkt->rssi = sig->rssi;
   \   00013C   85..82       MOV     DPL,?V0 + 2
   \   00013F   85..83       MOV     DPH,?V0 + 3
   \   000142   A3           INC     DPTR
   \   000143   A3           INC     DPTR
   \   000144   E0           MOVX    A,@DPTR
   \   000145   C0E0         PUSH    A
   \   000147   EE           MOV     A,R6
   \   000148   2418         ADD     A,#0x18
   \   00014A   F582         MOV     DPL,A
   \   00014C   EF           MOV     A,R7
   \   00014D   3400         ADDC    A,#0x0
   \   00014F   F583         MOV     DPH,A
   \   000151   D0E0         POP     A
   \   000153   F0           MOVX    @DPTR,A
    415            MSGpkt->SecurityUse = SecurityUse;
   \   000154   85..82       MOV     DPL,?XSP + 0
   \   000157   85..83       MOV     DPH,?XSP + 1
   \   00015A   E0           MOVX    A,@DPTR
   \   00015B   C0E0         PUSH    A
   \   00015D   EE           MOV     A,R6
   \   00015E   2419         ADD     A,#0x19
   \   000160   F582         MOV     DPL,A
   \   000162   EF           MOV     A,R7
   \   000163   3400         ADDC    A,#0x0
   \   000165   F583         MOV     DPH,A
   \   000167   D0E0         POP     A
   \   000169   F0           MOVX    @DPTR,A
    416            MSGpkt->timestamp = timestamp;
   \   00016A   EE           MOV     A,R6
   \   00016B   241A         ADD     A,#0x1a
   \   00016D   F582         MOV     DPL,A
   \   00016F   EF           MOV     A,R7
   \   000170   3400         ADDC    A,#0x0
   \   000172   F583         MOV     DPH,A
   \   000174   78..         MOV     R0,#?V0 + 4
   \   000176   12....       LCALL   ?L_MOV_TO_X
    417            MSGpkt->macDestAddr = aff->macDestAddr;
   \   000179   85..82       MOV     DPL,?V0 + 0
   \   00017C   85..83       MOV     DPH,?V0 + 1
   \   00017F   A3           INC     DPTR
   \   000180   A3           INC     DPTR
   \   000181   A3           INC     DPTR
   \   000182   A3           INC     DPTR
   \   000183   A3           INC     DPTR
   \   000184   A3           INC     DPTR
   \   000185   A3           INC     DPTR
   \   000186   A3           INC     DPTR
   \   000187   A3           INC     DPTR
   \   000188   A3           INC     DPTR
   \   000189   E0           MOVX    A,@DPTR
   \   00018A   F8           MOV     R0,A
   \   00018B   A3           INC     DPTR
   \   00018C   E0           MOVX    A,@DPTR
   \   00018D   F9           MOV     R1,A
   \   00018E   EE           MOV     A,R6
   \   00018F   2412         ADD     A,#0x12
   \   000191   F582         MOV     DPL,A
   \   000193   EF           MOV     A,R7
   \   000194   3400         ADDC    A,#0x0
   \   000196   F583         MOV     DPH,A
   \   000198   E8           MOV     A,R0
   \   000199   F0           MOVX    @DPTR,A
   \   00019A   A3           INC     DPTR
   \   00019B   E9           MOV     A,R1
   \   00019C   F0           MOVX    @DPTR,A
    418            MSGpkt->srcAddr.panId = SrcPanId;
   \   00019D   741B         MOV     A,#0x1b
   \   00019F   12....       LCALL   ?XSTACK_DISP0_8
   \   0001A2   E0           MOVX    A,@DPTR
   \   0001A3   F8           MOV     R0,A
   \   0001A4   A3           INC     DPTR
   \   0001A5   E0           MOVX    A,@DPTR
   \   0001A6   F9           MOV     R1,A
   \   0001A7   EE           MOV     A,R6
   \   0001A8   2410         ADD     A,#0x10
   \   0001AA   F582         MOV     DPL,A
   \   0001AC   EF           MOV     A,R7
   \   0001AD   3400         ADDC    A,#0x0
   \   0001AF   F583         MOV     DPH,A
   \   0001B1   E8           MOV     A,R0
   \   0001B2   F0           MOVX    @DPTR,A
   \   0001B3   A3           INC     DPTR
   \   0001B4   E9           MOV     A,R1
   \   0001B5   F0           MOVX    @DPTR,A
    419            MSGpkt->cmd.TransSeqNumber = 0;
   \   0001B6   EE           MOV     A,R6
   \   0001B7   241E         ADD     A,#0x1e
   \   0001B9   F582         MOV     DPL,A
   \   0001BB   EF           MOV     A,R7
   \   0001BC   3400         ADDC    A,#0x0
   \   0001BE   F583         MOV     DPH,A
   \   0001C0   7400         MOV     A,#0x0
   \   0001C2   F0           MOVX    @DPTR,A
    420            MSGpkt->cmd.DataLength = aff->asduLength;
   \   0001C3   E5..         MOV     A,?V0 + 0
   \   0001C5   2410         ADD     A,#0x10
   \   0001C7   F582         MOV     DPL,A
   \   0001C9   E5..         MOV     A,?V0 + 1
   \   0001CB   3400         ADDC    A,#0x0
   \   0001CD   F583         MOV     DPH,A
   \   0001CF   E0           MOVX    A,@DPTR
   \   0001D0   F8           MOV     R0,A
   \   0001D1   7900         MOV     R1,#0x0
   \   0001D3   EE           MOV     A,R6
   \   0001D4   241F         ADD     A,#0x1f
   \   0001D6   F582         MOV     DPL,A
   \   0001D8   EF           MOV     A,R7
   \   0001D9   3400         ADDC    A,#0x0
   \   0001DB   F583         MOV     DPH,A
   \   0001DD   E8           MOV     A,R0
   \   0001DE   F0           MOVX    @DPTR,A
   \   0001DF   A3           INC     DPTR
   \   0001E0   E9           MOV     A,R1
   \   0001E1   F0           MOVX    @DPTR,A
    421          
    422            if ( MSGpkt->cmd.DataLength )
   \   0001E2   EE           MOV     A,R6
   \   0001E3   241F         ADD     A,#0x1f
   \   0001E5   F582         MOV     DPL,A
   \   0001E7   EF           MOV     A,R7
   \   0001E8   3400         ADDC    A,#0x0
   \   0001EA   F583         MOV     DPH,A
   \   0001EC   E0           MOVX    A,@DPTR
   \   0001ED   F8           MOV     R0,A
   \   0001EE   A3           INC     DPTR
   \   0001EF   E0           MOVX    A,@DPTR
   \   0001F0   F9           MOV     R1,A
   \   0001F1   E8           MOV     A,R0
   \   0001F2   49           ORL     A,R1
   \   0001F3   604D         JZ      ??afBuildMSGIncoming_1
    423            {
    424              MSGpkt->cmd.Data = (byte *)(MSGpkt + 1);
   \   0001F5   EE           MOV     A,R6
   \   0001F6   2423         ADD     A,#0x23
   \   0001F8   F8           MOV     R0,A
   \   0001F9   EF           MOV     A,R7
   \   0001FA   3400         ADDC    A,#0x0
   \   0001FC   F9           MOV     R1,A
   \   0001FD   EE           MOV     A,R6
   \   0001FE   2421         ADD     A,#0x21
   \   000200   F582         MOV     DPL,A
   \   000202   EF           MOV     A,R7
   \   000203   3400         ADDC    A,#0x0
   \   000205   F583         MOV     DPH,A
   \   000207   E8           MOV     A,R0
   \   000208   F0           MOVX    @DPTR,A
   \   000209   A3           INC     DPTR
   \   00020A   E9           MOV     A,R1
   \   00020B   F0           MOVX    @DPTR,A
    425              osal_memcpy( MSGpkt->cmd.Data, asdu, MSGpkt->cmd.DataLength );
   \   00020C                ; Setup parameters for call to function osal_memcpy
   \   00020C   85....       MOV     ?V0 + 8,?V0 + 14
   \   00020F   85....       MOV     ?V0 + 9,?V0 + 15
   \   000212   75..00       MOV     ?V0 + 10,#0x0
   \   000215   78..         MOV     R0,#?V0 + 8
   \   000217   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00021A   EE           MOV     A,R6
   \   00021B   241F         ADD     A,#0x1f
   \   00021D   F582         MOV     DPL,A
   \   00021F   EF           MOV     A,R7
   \   000220   3400         ADDC    A,#0x0
   \   000222   F583         MOV     DPH,A
   \   000224   E0           MOVX    A,@DPTR
   \   000225   FC           MOV     R4,A
   \   000226   A3           INC     DPTR
   \   000227   E0           MOVX    A,@DPTR
   \   000228   FD           MOV     R5,A
   \   000229   EE           MOV     A,R6
   \   00022A   2421         ADD     A,#0x21
   \   00022C   F582         MOV     DPL,A
   \   00022E   EF           MOV     A,R7
   \   00022F   3400         ADDC    A,#0x0
   \   000231   F583         MOV     DPH,A
   \   000233   E0           MOVX    A,@DPTR
   \   000234   FA           MOV     R2,A
   \   000235   A3           INC     DPTR
   \   000236   E0           MOVX    A,@DPTR
   \   000237   FB           MOV     R3,A
   \   000238   12....       LCALL   ??osal_memcpy?relay
   \   00023B   7403         MOV     A,#0x3
   \   00023D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000240   8011         SJMP    ??afBuildMSGIncoming_2
    426            }
    427            else
    428            {
    429              MSGpkt->cmd.Data = NULL;
   \                     ??afBuildMSGIncoming_1:
   \   000242   EE           MOV     A,R6
   \   000243   2421         ADD     A,#0x21
   \   000245   F582         MOV     DPL,A
   \   000247   EF           MOV     A,R7
   \   000248   3400         ADDC    A,#0x0
   \   00024A   F583         MOV     DPH,A
   \   00024C   7400         MOV     A,#0x0
   \   00024E   F0           MOVX    @DPTR,A
   \   00024F   A3           INC     DPTR
   \   000250   7400         MOV     A,#0x0
   \   000252   F0           MOVX    @DPTR,A
    430            }
    431          
    432          #if defined ( MT_AF_CB_FUNC )
    433            // If ZDO or SAPI have registered for this endpoint, dont intercept it here
    434            if (AFCB_CHECK(CB_ID_AF_DATA_IND, *(epDesc->task_id)))
    435            {
    436              MT_AfIncomingMsg( (void *)MSGpkt );
    437              // Release the memory.
    438              osal_msg_deallocate( (void *)MSGpkt );
    439            }
    440            else
    441          #endif
    442            {
    443              // Send message through task message.
    444              osal_msg_send( *(epDesc->task_id), (uint8 *)MSGpkt );
   \                     ??afBuildMSGIncoming_2:
   \   000253                ; Setup parameters for call to function osal_msg_send
   \   000253   EE           MOV     A,R6
   \   000254   FA           MOV     R2,A
   \   000255   EF           MOV     A,R7
   \   000256   FB           MOV     R3,A
   \   000257   85..82       MOV     DPL,?V0 + 12
   \   00025A   85..83       MOV     DPH,?V0 + 13
   \   00025D   A3           INC     DPTR
   \   00025E   E0           MOVX    A,@DPTR
   \   00025F   F8           MOV     R0,A
   \   000260   A3           INC     DPTR
   \   000261   E0           MOVX    A,@DPTR
   \   000262   F583         MOV     DPH,A
   \   000264   8882         MOV     DPL,R0
   \   000266   E0           MOVX    A,@DPTR
   \   000267   F9           MOV     R1,A
   \   000268   12....       LCALL   ??osal_msg_send?relay
   \   00026B   E9           MOV     A,R1
    445            }
    446          }
   \                     ??afBuildMSGIncoming_0:
   \   00026C   7401         MOV     A,#0x1
   \   00026E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000271   7F10         MOV     R7,#0x10
   \   000273   02....       LJMP    ?BANKED_LEAVE_XDATA
    447          
    448          /*********************************************************************
    449           * @fn      AF_DataRequest
    450           *
    451           * @brief   Common functionality for invoking APSDE_DataReq() for both
    452           *          SendMulti and MSG-Send.
    453           *
    454           * input parameters
    455           *
    456           * @param  *dstAddr - Full ZB destination address: Nwk Addr + End Point.
    457           * @param  *srcEP - Origination (i.e. respond to or ack to) End Point Descr.
    458           * @param   cID - A valid cluster ID as specified by the Profile.
    459           * @param   len - Number of bytes of data pointed to by next param.
    460           * @param  *buf - A pointer to the data bytes to send.
    461           * @param  *transID - A pointer to a byte which can be modified and which will
    462           *                    be used as the transaction sequence number of the msg.
    463           * @param   options - Valid bit mask of Tx options.
    464           * @param   radius - Normally set to AF_DEFAULT_RADIUS.
    465           *
    466           * output parameters
    467           *
    468           * @param  *transID - Incremented by one if the return value is success.
    469           *
    470           * @return  afStatus_t - See previous definition of afStatus_... types.
    471           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
    472          uint8 AF_DataRequestDiscoverRoute = TRUE;
   \                     AF_DataRequestDiscoverRoute:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for AF_DataRequestDiscoverRoute>`
   \   000001                REQUIRE __INIT_XDATA_I

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    473          afStatus_t AF_DataRequest( afAddrType_t *dstAddr, endPointDesc_t *srcEP,
   \                     AF_DataRequest:
    474                                     uint16 cID, uint16 len, uint8 *buf, uint8 *transID,
    475                                     uint8 options, uint8 radius )
    476          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 32
   \   000005   74E0         MOV     A,#-0x20
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 3,R1
   \   000014   7438         MOV     A,#0x38
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 14,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 15,A
   \   000020   743A         MOV     A,#0x3a
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F5..         MOV     ?V0 + 12,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F5..         MOV     ?V0 + 13,A
   \   00002C   743E         MOV     A,#0x3e
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F5..         MOV     ?V0 + 4,A
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5..         MOV     ?V0 + 5,A
   \   000038   7440         MOV     A,#0x40
   \   00003A   12....       LCALL   ?XSTACK_DISP0_8
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   F5..         MOV     ?V0 + 8,A
    477            pDescCB pfnDescCB;
    478            ZStatus_t stat;
    479            APSDE_DataReq_t req;
    480            afDataReqMTU_t mtu;
    481          
    482            // Verify source end point
    483            if ( srcEP == NULL )
   \   000040   EE           MOV     A,R6
   \   000041   4F           ORL     A,R7
   \   000042   7005         JNZ     ??AF_DataRequest_0
    484            {
    485              return afStatus_INVALID_PARAMETER;
   \   000044   7902         MOV     R1,#0x2
   \   000046   02....       LJMP    ??AF_DataRequest_1 & 0xFFFF
    486            }
    487          
    488          #if !defined( REFLECTOR )
    489            if ( dstAddr->addrMode == afAddrNotPresent )
    490            {
    491              return afStatus_INVALID_PARAMETER;
    492            }
    493          #endif
    494          
    495            // Validate broadcasting
    496            if ( ( dstAddr->addrMode == afAddr16Bit     ) ||
    497                 ( dstAddr->addrMode == afAddrBroadcast )    )
   \                     ??AF_DataRequest_0:
   \   000049   85..82       MOV     DPL,?V0 + 0
   \   00004C   85..83       MOV     DPH,?V0 + 1
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   A3           INC     DPTR
   \   000054   A3           INC     DPTR
   \   000055   A3           INC     DPTR
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   6402         XRL     A,#0x2
   \   00005A   6013         JZ      ??AF_DataRequest_2
   \   00005C   85..82       MOV     DPL,?V0 + 0
   \   00005F   85..83       MOV     DPH,?V0 + 1
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   A3           INC     DPTR
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   640F         XRL     A,#0xf
   \   00006D   703C         JNZ     ??AF_DataRequest_3
    498            {
    499              // Check for valid broadcast values
    500              if( ADDR_NOT_BCAST != NLME_IsAddressBroadcast( dstAddr->addr.shortAddr )  )
   \                     ??AF_DataRequest_2:
   \   00006F                ; Setup parameters for call to function NLME_IsAddressBroadcast
   \   00006F   85..82       MOV     DPL,?V0 + 0
   \   000072   85..83       MOV     DPH,?V0 + 1
   \   000075   E0           MOVX    A,@DPTR
   \   000076   FA           MOV     R2,A
   \   000077   A3           INC     DPTR
   \   000078   E0           MOVX    A,@DPTR
   \   000079   FB           MOV     R3,A
   \   00007A   12....       LCALL   ??NLME_IsAddressBroadcast?relay
   \   00007D   E9           MOV     A,R1
   \   00007E   6013         JZ      ??AF_DataRequest_4
    501              {
    502                // Force mode to broadcast
    503                dstAddr->addrMode = afAddrBroadcast;
   \   000080   85..82       MOV     DPL,?V0 + 0
   \   000083   85..83       MOV     DPH,?V0 + 1
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   A3           INC     DPTR
   \   00008A   A3           INC     DPTR
   \   00008B   A3           INC     DPTR
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   740F         MOV     A,#0xf
   \   000090   F0           MOVX    @DPTR,A
   \   000091   8054         SJMP    ??AF_DataRequest_5
    504              }
    505              else
    506              {
    507                // Address is not a valid broadcast type
    508                if ( dstAddr->addrMode == afAddrBroadcast )
   \                     ??AF_DataRequest_4:
   \   000093   85..82       MOV     DPL,?V0 + 0
   \   000096   85..83       MOV     DPH,?V0 + 1
   \   000099   A3           INC     DPTR
   \   00009A   A3           INC     DPTR
   \   00009B   A3           INC     DPTR
   \   00009C   A3           INC     DPTR
   \   00009D   A3           INC     DPTR
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   E0           MOVX    A,@DPTR
   \   0000A2   640F         XRL     A,#0xf
   \   0000A4   7041         JNZ     ??AF_DataRequest_5
    509                {
    510                  return afStatus_INVALID_PARAMETER;
   \   0000A6   7902         MOV     R1,#0x2
   \   0000A8   02....       LJMP    ??AF_DataRequest_1 & 0xFFFF
    511                }
    512              }
    513            }
    514            else if ( dstAddr->addrMode != afAddr64Bit &&
    515                      dstAddr->addrMode != afAddrGroup &&
    516                      dstAddr->addrMode != afAddrNotPresent )
   \                     ??AF_DataRequest_3:
   \   0000AB   85..82       MOV     DPL,?V0 + 0
   \   0000AE   85..83       MOV     DPH,?V0 + 1
   \   0000B1   A3           INC     DPTR
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   A3           INC     DPTR
   \   0000B6   A3           INC     DPTR
   \   0000B7   A3           INC     DPTR
   \   0000B8   A3           INC     DPTR
   \   0000B9   E0           MOVX    A,@DPTR
   \   0000BA   6403         XRL     A,#0x3
   \   0000BC   6029         JZ      ??AF_DataRequest_5
   \   0000BE   85..82       MOV     DPL,?V0 + 0
   \   0000C1   85..83       MOV     DPH,?V0 + 1
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   A3           INC     DPTR
   \   0000C7   A3           INC     DPTR
   \   0000C8   A3           INC     DPTR
   \   0000C9   A3           INC     DPTR
   \   0000CA   A3           INC     DPTR
   \   0000CB   A3           INC     DPTR
   \   0000CC   E0           MOVX    A,@DPTR
   \   0000CD   6401         XRL     A,#0x1
   \   0000CF   6016         JZ      ??AF_DataRequest_5
   \   0000D1   85..82       MOV     DPL,?V0 + 0
   \   0000D4   85..83       MOV     DPH,?V0 + 1
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   A3           INC     DPTR
   \   0000DD   A3           INC     DPTR
   \   0000DE   A3           INC     DPTR
   \   0000DF   E0           MOVX    A,@DPTR
   \   0000E0   6005         JZ      ??AF_DataRequest_5
    517            {
    518              return afStatus_INVALID_PARAMETER;
   \   0000E2   7902         MOV     R1,#0x2
   \   0000E4   02....       LJMP    ??AF_DataRequest_1 & 0xFFFF
    519            }
    520            
    521            // Set destination address
    522            req.dstAddr.addrMode = dstAddr->addrMode;
   \                     ??AF_DataRequest_5:
   \   0000E7   85..82       MOV     DPL,?V0 + 0
   \   0000EA   85..83       MOV     DPH,?V0 + 1
   \   0000ED   A3           INC     DPTR
   \   0000EE   A3           INC     DPTR
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   A3           INC     DPTR
   \   0000F2   A3           INC     DPTR
   \   0000F3   A3           INC     DPTR
   \   0000F4   A3           INC     DPTR
   \   0000F5   E0           MOVX    A,@DPTR
   \   0000F6   C0E0         PUSH    A
   \   0000F8   740C         MOV     A,#0xc
   \   0000FA   12....       LCALL   ?XSTACK_DISP0_8
   \   0000FD   D0E0         POP     A
   \   0000FF   F0           MOVX    @DPTR,A
    523            if ( dstAddr->addrMode == afAddr64Bit )
   \   000100   85..82       MOV     DPL,?V0 + 0
   \   000103   85..83       MOV     DPH,?V0 + 1
   \   000106   A3           INC     DPTR
   \   000107   A3           INC     DPTR
   \   000108   A3           INC     DPTR
   \   000109   A3           INC     DPTR
   \   00010A   A3           INC     DPTR
   \   00010B   A3           INC     DPTR
   \   00010C   A3           INC     DPTR
   \   00010D   A3           INC     DPTR
   \   00010E   E0           MOVX    A,@DPTR
   \   00010F   6403         XRL     A,#0x3
   \   000111   7012         JNZ     ??AF_DataRequest_6
    524              osal_cpyExtAddr( req.dstAddr.addr.extAddr, dstAddr->addr.extAddr );
   \   000113                ; Setup parameters for call to function sAddrExtCpy
   \   000113   AC..         MOV     R4,?V0 + 0
   \   000115   AD..         MOV     R5,?V0 + 1
   \   000117   7404         MOV     A,#0x4
   \   000119   12....       LCALL   ?XSTACK_DISP0_8
   \   00011C   AA82         MOV     R2,DPL
   \   00011E   AB83         MOV     R3,DPH
   \   000120   12....       LCALL   ??sAddrExtCpy?relay
   \   000123   8015         SJMP    ??AF_DataRequest_7
    525            else
    526              req.dstAddr.addr.shortAddr = dstAddr->addr.shortAddr;
   \                     ??AF_DataRequest_6:
   \   000125   85..82       MOV     DPL,?V0 + 0
   \   000128   85..83       MOV     DPH,?V0 + 1
   \   00012B   E0           MOVX    A,@DPTR
   \   00012C   F8           MOV     R0,A
   \   00012D   A3           INC     DPTR
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   F9           MOV     R1,A
   \   000130   7404         MOV     A,#0x4
   \   000132   12....       LCALL   ?XSTACK_DISP0_8
   \   000135   E8           MOV     A,R0
   \   000136   F0           MOVX    @DPTR,A
   \   000137   A3           INC     DPTR
   \   000138   E9           MOV     A,R1
   \   000139   F0           MOVX    @DPTR,A
    527            
    528            req.profileID = ZDO_PROFILE_ID;
   \                     ??AF_DataRequest_7:
   \   00013A   7413         MOV     A,#0x13
   \   00013C   12....       LCALL   ?XSTACK_DISP0_8
   \   00013F   7400         MOV     A,#0x0
   \   000141   F0           MOVX    @DPTR,A
   \   000142   A3           INC     DPTR
   \   000143   7400         MOV     A,#0x0
   \   000145   F0           MOVX    @DPTR,A
    529          
    530            if ( (pfnDescCB = afGetDescCB( srcEP )) )
   \   000146                ; Setup parameters for call to function afGetDescCB
   \   000146   EE           MOV     A,R6
   \   000147   FA           MOV     R2,A
   \   000148   EF           MOV     A,R7
   \   000149   FB           MOV     R3,A
   \   00014A   12....       LCALL   ??afGetDescCB?relay
   \   00014D   8A..         MOV     ?V0 + 6,R2
   \   00014F   8B..         MOV     ?V0 + 7,R3
   \   000151   A8..         MOV     R0,?V0 + 6
   \   000153   A9..         MOV     R1,?V0 + 7
   \   000155   7402         MOV     A,#0x2
   \   000157   12....       LCALL   ?XSTACK_DISP0_8
   \   00015A   E8           MOV     A,R0
   \   00015B   F0           MOVX    @DPTR,A
   \   00015C   A3           INC     DPTR
   \   00015D   E9           MOV     A,R1
   \   00015E   F0           MOVX    @DPTR,A
   \   00015F   E8           MOV     A,R0
   \   000160   49           ORL     A,R1
   \   000161   6046         JZ      ??AF_DataRequest_8
    531            {
    532              uint16 *pID = (uint16 *)(pfnDescCB(
    533                                           AF_DESCRIPTOR_PROFILE_ID, srcEP->endPoint ));
   \   000163                ; Setup parameters for indirect call
   \   000163   8E82         MOV     DPL,R6
   \   000165   8F83         MOV     DPH,R7
   \   000167   E0           MOVX    A,@DPTR
   \   000168   FA           MOV     R2,A
   \   000169   7902         MOV     R1,#0x2
   \   00016B   7402         MOV     A,#0x2
   \   00016D   12....       LCALL   ?XSTACK_DISP0_8
   \   000170   E0           MOVX    A,@DPTR
   \   000171   F8           MOV     R0,A
   \   000172   A3           INC     DPTR
   \   000173   E0           MOVX    A,@DPTR
   \   000174   F583         MOV     DPH,A
   \   000176   8882         MOV     DPL,R0
   \   000178   12....       LCALL   ?CALL_IND
   \   00017B   8A..         MOV     ?V0 + 10,R2
   \   00017D   8B..         MOV     ?V0 + 11,R3
   \   00017F   85....       MOV     ?V0 + 6,?V0 + 10
   \   000182   85....       MOV     ?V0 + 7,?V0 + 11
    534              if ( pID )
   \   000185   E5..         MOV     A,?V0 + 6
   \   000187   45..         ORL     A,?V0 + 7
   \   000189   604D         JZ      ??AF_DataRequest_9
    535              {
    536                req.profileID = *pID;
   \   00018B   85..82       MOV     DPL,?V0 + 6
   \   00018E   85..83       MOV     DPH,?V0 + 7
   \   000191   E0           MOVX    A,@DPTR
   \   000192   F8           MOV     R0,A
   \   000193   A3           INC     DPTR
   \   000194   E0           MOVX    A,@DPTR
   \   000195   F9           MOV     R1,A
   \   000196   7413         MOV     A,#0x13
   \   000198   12....       LCALL   ?XSTACK_DISP0_8
   \   00019B   E8           MOV     A,R0
   \   00019C   F0           MOVX    @DPTR,A
   \   00019D   A3           INC     DPTR
   \   00019E   E9           MOV     A,R1
   \   00019F   F0           MOVX    @DPTR,A
    537                osal_mem_free( pID );
   \   0001A0                ; Setup parameters for call to function osal_mem_free
   \   0001A0   AA..         MOV     R2,?V0 + 6
   \   0001A2   AB..         MOV     R3,?V0 + 7
   \   0001A4   12....       LCALL   ??osal_mem_free?relay
   \   0001A7   802F         SJMP    ??AF_DataRequest_9
    538              }
    539            }
    540            else if ( srcEP->simpleDesc )
   \                     ??AF_DataRequest_8:
   \   0001A9   8E82         MOV     DPL,R6
   \   0001AB   8F83         MOV     DPH,R7
   \   0001AD   A3           INC     DPTR
   \   0001AE   A3           INC     DPTR
   \   0001AF   A3           INC     DPTR
   \   0001B0   E0           MOVX    A,@DPTR
   \   0001B1   F8           MOV     R0,A
   \   0001B2   A3           INC     DPTR
   \   0001B3   E0           MOVX    A,@DPTR
   \   0001B4   F9           MOV     R1,A
   \   0001B5   E8           MOV     A,R0
   \   0001B6   49           ORL     A,R1
   \   0001B7   601F         JZ      ??AF_DataRequest_9
    541            {
    542              req.profileID = srcEP->simpleDesc->AppProfId;
   \   0001B9   8E82         MOV     DPL,R6
   \   0001BB   8F83         MOV     DPH,R7
   \   0001BD   A3           INC     DPTR
   \   0001BE   A3           INC     DPTR
   \   0001BF   A3           INC     DPTR
   \   0001C0   E0           MOVX    A,@DPTR
   \   0001C1   F8           MOV     R0,A
   \   0001C2   A3           INC     DPTR
   \   0001C3   E0           MOVX    A,@DPTR
   \   0001C4   F583         MOV     DPH,A
   \   0001C6   8882         MOV     DPL,R0
   \   0001C8   A3           INC     DPTR
   \   0001C9   E0           MOVX    A,@DPTR
   \   0001CA   F8           MOV     R0,A
   \   0001CB   A3           INC     DPTR
   \   0001CC   E0           MOVX    A,@DPTR
   \   0001CD   F9           MOV     R1,A
   \   0001CE   7413         MOV     A,#0x13
   \   0001D0   12....       LCALL   ?XSTACK_DISP0_8
   \   0001D3   E8           MOV     A,R0
   \   0001D4   F0           MOVX    @DPTR,A
   \   0001D5   A3           INC     DPTR
   \   0001D6   E9           MOV     A,R1
   \   0001D7   F0           MOVX    @DPTR,A
    543            }
    544          
    545            req.txOptions = 0;
   \                     ??AF_DataRequest_9:
   \   0001D8   7419         MOV     A,#0x19
   \   0001DA   12....       LCALL   ?XSTACK_DISP0_8
   \   0001DD   7400         MOV     A,#0x0
   \   0001DF   F0           MOVX    @DPTR,A
   \   0001E0   A3           INC     DPTR
   \   0001E1   7400         MOV     A,#0x0
   \   0001E3   F0           MOVX    @DPTR,A
    546          
    547            if ( ( options & AF_ACK_REQUEST              ) &&
    548                 ( req.dstAddr.addrMode != AddrBroadcast ) &&
    549                 ( req.dstAddr.addrMode != AddrGroup     )    )
   \   0001E4   E5..         MOV     A,?V0 + 3
   \   0001E6   A2E4         MOV     C,0xE0 /* A   */.4
   \   0001E8   5022         JNC     ??AF_DataRequest_10
   \   0001EA   740C         MOV     A,#0xc
   \   0001EC   12....       LCALL   ?XSTACK_DISP0_8
   \   0001EF   E0           MOVX    A,@DPTR
   \   0001F0   640F         XRL     A,#0xf
   \   0001F2   6018         JZ      ??AF_DataRequest_10
   \   0001F4   740C         MOV     A,#0xc
   \   0001F6   12....       LCALL   ?XSTACK_DISP0_8
   \   0001F9   E0           MOVX    A,@DPTR
   \   0001FA   6401         XRL     A,#0x1
   \   0001FC   600E         JZ      ??AF_DataRequest_10
    550            {
    551              req.txOptions |=  APS_TX_OPTIONS_ACK;
   \   0001FE   7419         MOV     A,#0x19
   \   000200   12....       LCALL   ?XSTACK_DISP0_8
   \   000203   E0           MOVX    A,@DPTR
   \   000204   4404         ORL     A,#0x4
   \   000206   F0           MOVX    @DPTR,A
   \   000207   A3           INC     DPTR
   \   000208   E0           MOVX    A,@DPTR
   \   000209   4400         ORL     A,#0x0
   \   00020B   F0           MOVX    @DPTR,A
    552            }
    553          
    554            if ( options & AF_SKIP_ROUTING )
   \                     ??AF_DataRequest_10:
   \   00020C   E5..         MOV     A,?V0 + 3
   \   00020E   A2E7         MOV     C,0xE0 /* A   */.7
   \   000210   500E         JNC     ??AF_DataRequest_11
    555            {
    556              req.txOptions |=  APS_TX_OPTIONS_SKIP_ROUTING;
   \   000212   7419         MOV     A,#0x19
   \   000214   12....       LCALL   ?XSTACK_DISP0_8
   \   000217   E0           MOVX    A,@DPTR
   \   000218   4410         ORL     A,#0x10
   \   00021A   F0           MOVX    @DPTR,A
   \   00021B   A3           INC     DPTR
   \   00021C   E0           MOVX    A,@DPTR
   \   00021D   4400         ORL     A,#0x0
   \   00021F   F0           MOVX    @DPTR,A
    557            }
    558          
    559            if ( options & AF_EN_SECURITY )
   \                     ??AF_DataRequest_11:
   \   000220   E5..         MOV     A,?V0 + 3
   \   000222   A2E6         MOV     C,0xE0 /* A   */.6
   \   000224   5018         JNC     ??AF_DataRequest_12
    560            {
    561              req.txOptions |= APS_TX_OPTIONS_SECURITY_ENABLE;
   \   000226   7419         MOV     A,#0x19
   \   000228   12....       LCALL   ?XSTACK_DISP0_8
   \   00022B   E0           MOVX    A,@DPTR
   \   00022C   4401         ORL     A,#0x1
   \   00022E   F0           MOVX    @DPTR,A
   \   00022F   A3           INC     DPTR
   \   000230   E0           MOVX    A,@DPTR
   \   000231   4400         ORL     A,#0x0
   \   000233   F0           MOVX    @DPTR,A
    562              mtu.aps.secure = TRUE;
   \   000234   7401         MOV     A,#0x1
   \   000236   12....       LCALL   ?XSTACK_DISP0_8
   \   000239   7401         MOV     A,#0x1
   \   00023B   F0           MOVX    @DPTR,A
   \   00023C   8008         SJMP    ??AF_DataRequest_13
    563            }
    564            else
    565            {
    566              mtu.aps.secure = FALSE;
   \                     ??AF_DataRequest_12:
   \   00023E   7401         MOV     A,#0x1
   \   000240   12....       LCALL   ?XSTACK_DISP0_8
   \   000243   7400         MOV     A,#0x0
   \   000245   F0           MOVX    @DPTR,A
    567            }
    568          
    569            mtu.kvp = FALSE;
   \                     ??AF_DataRequest_13:
   \   000246   85..82       MOV     DPL,?XSP + 0
   \   000249   85..83       MOV     DPH,?XSP + 1
   \   00024C   7400         MOV     A,#0x0
   \   00024E   F0           MOVX    @DPTR,A
    570          
    571            req.transID       = *transID;
   \   00024F   85..82       MOV     DPL,?V0 + 4
   \   000252   85..83       MOV     DPH,?V0 + 5
   \   000255   E0           MOVX    A,@DPTR
   \   000256   C0E0         PUSH    A
   \   000258   741B         MOV     A,#0x1b
   \   00025A   12....       LCALL   ?XSTACK_DISP0_8
   \   00025D   D0E0         POP     A
   \   00025F   F0           MOVX    @DPTR,A
    572            req.srcEP         = srcEP->endPoint;
   \   000260   8E82         MOV     DPL,R6
   \   000262   8F83         MOV     DPH,R7
   \   000264   E0           MOVX    A,@DPTR
   \   000265   C0E0         PUSH    A
   \   000267   740D         MOV     A,#0xd
   \   000269   12....       LCALL   ?XSTACK_DISP0_8
   \   00026C   D0E0         POP     A
   \   00026E   F0           MOVX    @DPTR,A
    573            req.dstEP         = dstAddr->endPoint;
   \   00026F   85..82       MOV     DPL,?V0 + 0
   \   000272   85..83       MOV     DPH,?V0 + 1
   \   000275   A3           INC     DPTR
   \   000276   A3           INC     DPTR
   \   000277   A3           INC     DPTR
   \   000278   A3           INC     DPTR
   \   000279   A3           INC     DPTR
   \   00027A   A3           INC     DPTR
   \   00027B   A3           INC     DPTR
   \   00027C   A3           INC     DPTR
   \   00027D   A3           INC     DPTR
   \   00027E   E0           MOVX    A,@DPTR
   \   00027F   C0E0         PUSH    A
   \   000281   740E         MOV     A,#0xe
   \   000283   12....       LCALL   ?XSTACK_DISP0_8
   \   000286   D0E0         POP     A
   \   000288   F0           MOVX    @DPTR,A
    574            req.clusterID     = cID;
   \   000289   7411         MOV     A,#0x11
   \   00028B   12....       LCALL   ?XSTACK_DISP0_8
   \   00028E   E5..         MOV     A,?V0 + 14
   \   000290   F0           MOVX    @DPTR,A
   \   000291   A3           INC     DPTR
   \   000292   E5..         MOV     A,?V0 + 15
   \   000294   F0           MOVX    @DPTR,A
    575            req.asduLen       = len;
   \   000295   7415         MOV     A,#0x15
   \   000297   12....       LCALL   ?XSTACK_DISP0_8
   \   00029A   E5..         MOV     A,?V0 + 12
   \   00029C   F0           MOVX    @DPTR,A
   \   00029D   A3           INC     DPTR
   \   00029E   E5..         MOV     A,?V0 + 13
   \   0002A0   F0           MOVX    @DPTR,A
    576            req.asdu          = buf;
   \   0002A1   743C         MOV     A,#0x3c
   \   0002A3   12....       LCALL   ?XSTACK_DISP0_8
   \   0002A6   E0           MOVX    A,@DPTR
   \   0002A7   F8           MOV     R0,A
   \   0002A8   A3           INC     DPTR
   \   0002A9   E0           MOVX    A,@DPTR
   \   0002AA   F9           MOV     R1,A
   \   0002AB   7417         MOV     A,#0x17
   \   0002AD   12....       LCALL   ?XSTACK_DISP0_8
   \   0002B0   E8           MOV     A,R0
   \   0002B1   F0           MOVX    @DPTR,A
   \   0002B2   A3           INC     DPTR
   \   0002B3   E9           MOV     A,R1
   \   0002B4   F0           MOVX    @DPTR,A
    577            req.discoverRoute = AF_DataRequestDiscoverRoute;//(uint8)((options & AF_DISCV_ROUTE) ? 1 : 0);
   \   0002B5   90....       MOV     DPTR,#AF_DataRequestDiscoverRoute
   \   0002B8   E0           MOVX    A,@DPTR
   \   0002B9   C0E0         PUSH    A
   \   0002BB   741C         MOV     A,#0x1c
   \   0002BD   12....       LCALL   ?XSTACK_DISP0_8
   \   0002C0   D0E0         POP     A
   \   0002C2   F0           MOVX    @DPTR,A
    578            req.radiusCounter = radius;
   \   0002C3   E5..         MOV     A,?V0 + 8
   \   0002C5   741D         MOV     A,#0x1d
   \   0002C7   12....       LCALL   ?XSTACK_DISP0_8
   \   0002CA   E5..         MOV     A,?V0 + 8
   \   0002CC   F0           MOVX    @DPTR,A
    579          #if defined ( INTER_PAN )
    580            req.dstPanId      = dstAddr->panId;
    581          
    582            if ( StubAPS_InterPan( dstAddr->panId, dstAddr->endPoint ) )
    583            {
    584              if ( len > INTERP_DataReqMTU() )
    585              {
    586                stat = afStatus_INVALID_PARAMETER;
    587              }
    588              else
    589              {
    590                stat = INTERP_DataReq( &req );
    591              }
    592            }
    593            else
    594          #endif // INTER_PAN
    595            {
    596              if (len > afDataReqMTU( &mtu ) )
   \   0002CD                ; Setup parameters for call to function afDataReqMTU
   \   0002CD   85..82       MOV     DPL,?XSP + 0
   \   0002D0   85..83       MOV     DPH,?XSP + 1
   \   0002D3   AA82         MOV     R2,DPL
   \   0002D5   AB83         MOV     R3,DPH
   \   0002D7   12....       LCALL   ??afDataReqMTU?relay
   \   0002DA   E9           MOV     A,R1
   \   0002DB   F8           MOV     R0,A
   \   0002DC   7900         MOV     R1,#0x0
   \   0002DE   C3           CLR     C
   \   0002DF   95..         SUBB    A,?V0 + 12
   \   0002E1   E9           MOV     A,R1
   \   0002E2   95..         SUBB    A,?V0 + 13
   \   0002E4   502D         JNC     ??AF_DataRequest_14
    597              {
    598                if (apsfSendFragmented)
   \   0002E6   90....       MOV     DPTR,#apsfSendFragmented
   \   0002E9   E0           MOVX    A,@DPTR
   \   0002EA   F8           MOV     R0,A
   \   0002EB   A3           INC     DPTR
   \   0002EC   E0           MOVX    A,@DPTR
   \   0002ED   F9           MOV     R1,A
   \   0002EE   E8           MOV     A,R0
   \   0002EF   49           ORL     A,R1
   \   0002F0   601C         JZ      ??AF_DataRequest_15
    599                {
    600                  stat = (*apsfSendFragmented)( &req );
   \   0002F2                ; Setup parameters for indirect call
   \   0002F2   7404         MOV     A,#0x4
   \   0002F4   12....       LCALL   ?XSTACK_DISP0_8
   \   0002F7   AA82         MOV     R2,DPL
   \   0002F9   AB83         MOV     R3,DPH
   \   0002FB   90....       MOV     DPTR,#apsfSendFragmented
   \   0002FE   E0           MOVX    A,@DPTR
   \   0002FF   F8           MOV     R0,A
   \   000300   A3           INC     DPTR
   \   000301   E0           MOVX    A,@DPTR
   \   000302   F583         MOV     DPH,A
   \   000304   8882         MOV     DPL,R0
   \   000306   12....       LCALL   ?CALL_IND
   \   000309   E9           MOV     A,R1
   \   00030A   F5..         MOV     ?V0 + 2,A
   \   00030C   8014         SJMP    ??AF_DataRequest_16
    601                }
    602                else
    603                {
    604                  stat = afStatus_INVALID_PARAMETER;
   \                     ??AF_DataRequest_15:
   \   00030E   75..02       MOV     ?V0 + 2,#0x2
   \   000311   800F         SJMP    ??AF_DataRequest_16
    605                }
    606              }
    607              else
    608              {
    609                stat = APSDE_DataReq( &req );
   \                     ??AF_DataRequest_14:
   \   000313                ; Setup parameters for call to function APSDE_DataReq
   \   000313   7404         MOV     A,#0x4
   \   000315   12....       LCALL   ?XSTACK_DISP0_8
   \   000318   AA82         MOV     R2,DPL
   \   00031A   AB83         MOV     R3,DPH
   \   00031C   12....       LCALL   ??APSDE_DataReq?relay
   \   00031F   E9           MOV     A,R1
   \   000320   F5..         MOV     ?V0 + 2,A
    610              }
    611            }
    612          
    613            /*
    614             * If this is an EndPoint-to-EndPoint message on the same device, it will not
    615             * get added to the NWK databufs. So it will not go OTA and it will not get
    616             * a MACCB_DATA_CONFIRM_CMD callback. Thus it is necessary to generate the
    617             * AF_DATA_CONFIRM_CMD here. Note that APSDE_DataConfirm() only generates one
    618             * message with the first in line TransSeqNumber, even on a multi message.
    619             * Also note that a reflected msg will not have its confirmation generated
    620             * here.
    621             */
    622            if ( (req.dstAddr.addrMode == Addr16Bit) &&
    623                 (req.dstAddr.addr.shortAddr == NLME_GetShortAddr()) )
   \                     ??AF_DataRequest_16:
   \   000322   740C         MOV     A,#0xc
   \   000324   12....       LCALL   ?XSTACK_DISP0_8
   \   000327   E0           MOVX    A,@DPTR
   \   000328   6402         XRL     A,#0x2
   \   00032A   702C         JNZ     ??AF_DataRequest_17
   \   00032C                ; Setup parameters for call to function NLME_GetShortAddr
   \   00032C   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00032F   8A..         MOV     ?V0 + 6,R2
   \   000331   8B..         MOV     ?V0 + 7,R3
   \   000333   A8..         MOV     R0,?V0 + 6
   \   000335   A9..         MOV     R1,?V0 + 7
   \   000337   7404         MOV     A,#0x4
   \   000339   12....       LCALL   ?XSTACK_DISP0_8
   \   00033C   E0           MOVX    A,@DPTR
   \   00033D   68           XRL     A,R0
   \   00033E   7003         JNZ     ??AF_DataRequest_18
   \   000340   A3           INC     DPTR
   \   000341   E0           MOVX    A,@DPTR
   \   000342   69           XRL     A,R1
   \                     ??AF_DataRequest_18:
   \   000343   7013         JNZ     ??AF_DataRequest_17
    624            {
    625              afDataConfirm( srcEP->endPoint, *transID, stat );
   \   000345                ; Setup parameters for call to function afDataConfirm
   \   000345   AB..         MOV     R3,?V0 + 2
   \   000347   85..82       MOV     DPL,?V0 + 4
   \   00034A   85..83       MOV     DPH,?V0 + 5
   \   00034D   E0           MOVX    A,@DPTR
   \   00034E   FA           MOV     R2,A
   \   00034F   8E82         MOV     DPL,R6
   \   000351   8F83         MOV     DPH,R7
   \   000353   E0           MOVX    A,@DPTR
   \   000354   F9           MOV     R1,A
   \   000355   12....       LCALL   ??afDataConfirm?relay
    626            }
    627          
    628            if ( stat == afStatus_SUCCESS )
   \                     ??AF_DataRequest_17:
   \   000358   E5..         MOV     A,?V0 + 2
   \   00035A   700A         JNZ     ??AF_DataRequest_19
    629            {
    630              (*transID)++;
   \   00035C   85..82       MOV     DPL,?V0 + 4
   \   00035F   85..83       MOV     DPH,?V0 + 5
   \   000362   E0           MOVX    A,@DPTR
   \   000363   2401         ADD     A,#0x1
   \   000365   F0           MOVX    @DPTR,A
    631            }
    632          
    633            return (afStatus_t)stat;
   \                     ??AF_DataRequest_19:
   \   000366   A9..         MOV     R1,?V0 + 2
   \                     ??AF_DataRequest_1:
   \   000368   7420         MOV     A,#0x20
   \   00036A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00036D   7F10         MOV     R7,#0x10
   \   00036F   02....       LJMP    ?BANKED_LEAVE_XDATA
    634          }
    635          
    636          #if defined ( ZIGBEE_SOURCE_ROUTING )
    637          /*********************************************************************
    638           * @fn      AF_DataRequestSrcRtg
    639           *
    640           * @brief   Common functionality for invoking APSDE_DataReq() for both
    641           *          SendMulti and MSG-Send.
    642           *
    643           * input parameters
    644           *
    645           * @param  *dstAddr - Full ZB destination address: Nwk Addr + End Point.
    646           * @param  *srcEP - Origination (i.e. respond to or ack to) End Point Descr.
    647           * @param   cID - A valid cluster ID as specified by the Profile.
    648           * @param   len - Number of bytes of data pointed to by next param.
    649           * @param  *buf - A pointer to the data bytes to send.
    650           * @param  *transID - A pointer to a byte which can be modified and which will
    651           *                    be used as the transaction sequence number of the msg.
    652           * @param   options - Valid bit mask of Tx options.
    653           * @param   radius - Normally set to AF_DEFAULT_RADIUS.
    654           * @param   relayCnt - Number of devices in the relay list
    655           * @param   pRelayList - Pointer to the relay list
    656           *
    657           * output parameters
    658           *
    659           * @param  *transID - Incremented by one if the return value is success.
    660           *
    661           * @return  afStatus_t - See previous definition of afStatus_... types.
    662           */
    663          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    664          afStatus_t AF_DataRequestSrcRtg( afAddrType_t *dstAddr, endPointDesc_t *srcEP,
   \                     AF_DataRequestSrcRtg:
    665                                     uint16 cID, uint16 len, uint8 *buf, uint8 *transID,
    666                                     uint8 options, uint8 radius, uint8 relayCnt, uint16* pRelayList )
    667          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 6,R2
   \   000007   8B..         MOV     ?V0 + 7,R3
   \   000009   8C..         MOV     ?V0 + 10,R4
   \   00000B   8D..         MOV     ?V0 + 11,R5
   \   00000D   89..         MOV     ?V0 + 5,R1
   \   00000F   7418         MOV     A,#0x18
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 1,A
   \   00001B   741A         MOV     A,#0x1a
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FE           MOV     R6,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FF           MOV     R7,A
   \   000025   741C         MOV     A,#0x1c
   \   000027   12....       LCALL   ?XSTACK_DISP0_8
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F5..         MOV     ?V0 + 14,A
   \   00002D   A3           INC     DPTR
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F5..         MOV     ?V0 + 15,A
   \   000031   741E         MOV     A,#0x1e
   \   000033   12....       LCALL   ?XSTACK_DISP0_8
   \   000036   E0           MOVX    A,@DPTR
   \   000037   F5..         MOV     ?V0 + 12,A
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F5..         MOV     ?V0 + 13,A
   \   00003D   7420         MOV     A,#0x20
   \   00003F   12....       LCALL   ?XSTACK_DISP0_8
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F5..         MOV     ?V0 + 4,A
   \   000045   7421         MOV     A,#0x21
   \   000047   12....       LCALL   ?XSTACK_DISP0_8
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F5..         MOV     ?V0 + 2,A
    668            uint8 status;
    669            
    670            /* Add the source route to the source routing table */
    671            status = RTG_AddSrcRtgEntry_Guaranteed( dstAddr->addr.shortAddr, relayCnt, 
    672                                                   pRelayList );
   \   00004D                ; Setup parameters for call to function RTG_AddSrcRtgEntry_Guaranteed
   \   00004D   7422         MOV     A,#0x22
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \   000052   E0           MOVX    A,@DPTR
   \   000053   FC           MOV     R4,A
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   FD           MOV     R5,A
   \   000057   A9..         MOV     R1,?V0 + 2
   \   000059   85..82       MOV     DPL,?V0 + 6
   \   00005C   85..83       MOV     DPH,?V0 + 7
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   FA           MOV     R2,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   FB           MOV     R3,A
   \   000064   12....       LCALL   ??RTG_AddSrcRtgEntry_Guaranteed?relay
   \   000067   E9           MOV     A,R1
   \   000068   F5..         MOV     ?V0 + 3,A
    673          
    674            if( status == RTG_SUCCESS)
   \   00006A   E5..         MOV     A,?V0 + 3
   \   00006C   7044         JNZ     ??AF_DataRequestSrcRtg_0
    675            {
    676              /* Call AF_DataRequest to send the data */
    677              status = AF_DataRequest( dstAddr, srcEP, cID, len, buf, transID, options, radius );
   \   00006E                ; Setup parameters for call to function AF_DataRequest
   \   00006E   E5..         MOV     A,?V0 + 4
   \   000070   F5..         MOV     ?V0 + 8,A
   \   000072   78..         MOV     R0,#?V0 + 8
   \   000074   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000077   85....       MOV     ?V0 + 8,?V0 + 12
   \   00007A   85....       MOV     ?V0 + 9,?V0 + 13
   \   00007D   78..         MOV     R0,#?V0 + 8
   \   00007F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000082   85....       MOV     ?V0 + 8,?V0 + 14
   \   000085   85....       MOV     ?V0 + 9,?V0 + 15
   \   000088   78..         MOV     R0,#?V0 + 8
   \   00008A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008D   8E..         MOV     ?V0 + 8,R6
   \   00008F   8F..         MOV     ?V0 + 9,R7
   \   000091   78..         MOV     R0,#?V0 + 8
   \   000093   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000096   78..         MOV     R0,#?V0 + 0
   \   000098   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009B   A9..         MOV     R1,?V0 + 5
   \   00009D   AC..         MOV     R4,?V0 + 10
   \   00009F   AD..         MOV     R5,?V0 + 11
   \   0000A1   AA..         MOV     R2,?V0 + 6
   \   0000A3   AB..         MOV     R3,?V0 + 7
   \   0000A5   12....       LCALL   ??AF_DataRequest?relay
   \   0000A8   7409         MOV     A,#0x9
   \   0000AA   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AD   E9           MOV     A,R1
   \   0000AE   F5..         MOV     ?V0 + 3,A
   \   0000B0   800E         SJMP    ??AF_DataRequestSrcRtg_1
    678            }
    679            else if( status == RTG_INVALID_PATH )
   \                     ??AF_DataRequestSrcRtg_0:
   \   0000B2   7405         MOV     A,#0x5
   \   0000B4   65..         XRL     A,?V0 + 3
   \   0000B6   7005         JNZ     ??AF_DataRequestSrcRtg_2
    680            {
    681              /* The source route relay count is exceeding the network limit */
    682              status = afStatus_INVALID_PARAMETER;
   \   0000B8   75..02       MOV     ?V0 + 3,#0x2
   \   0000BB   8003         SJMP    ??AF_DataRequestSrcRtg_1
    683            }
    684            else
    685            {
    686              /* The guaranteed adding entry fails due to memory failure */
    687              status = afStatus_MEM_FAIL;
   \                     ??AF_DataRequestSrcRtg_2:
   \   0000BD   75..10       MOV     ?V0 + 3,#0x10
    688            }
    689            return status;
   \                     ??AF_DataRequestSrcRtg_1:
   \   0000C0   A9..         MOV     R1,?V0 + 3
   \   0000C2   7F10         MOV     R7,#0x10
   \   0000C4   02....       LJMP    ?BANKED_LEAVE_XDATA
    690          }
    691          
    692          #endif
    693          
    694          /*********************************************************************
    695           * @fn      afFindEndPointDescList
    696           *
    697           * @brief   Find the endpoint description entry from the endpoint
    698           *          number.
    699           *
    700           * @param   EndPoint - Application Endpoint to look for
    701           *
    702           * @return  the address to the endpoint/interface description entry
    703           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    704          static epList_t *afFindEndPointDescList( byte EndPoint )
   \                     afFindEndPointDescList:
    705          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    706            epList_t *epSearch;
    707          
    708            // Start at the beginning
    709            epSearch = epList;
   \   000004   90....       MOV     DPTR,#epList
   \   000007   E0           MOVX    A,@DPTR
   \   000008   FA           MOV     R2,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FB           MOV     R3,A
   \   00000C   EA           MOV     A,R2
   \   00000D   FC           MOV     R4,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FD           MOV     R5,A
    710          
    711            // Look through the list until the end
    712            while ( epSearch )
   \                     ??afFindEndPointDescList_0:
   \   000010   EC           MOV     A,R4
   \   000011   4D           ORL     A,R5
   \   000012   6026         JZ      ??afFindEndPointDescList_1
    713            {
    714              // Is there a match?
    715              if ( epSearch->epDesc->endPoint == EndPoint )
   \   000014   8C82         MOV     DPL,R4
   \   000016   8D83         MOV     DPH,R5
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F8           MOV     R0,A
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F583         MOV     DPH,A
   \   00001E   8882         MOV     DPL,R0
   \   000020   E0           MOVX    A,@DPTR
   \   000021   69           XRL     A,R1
   \   000022   7006         JNZ     ??afFindEndPointDescList_2
    716              {
    717                return ( epSearch );
   \   000024   EC           MOV     A,R4
   \   000025   FA           MOV     R2,A
   \   000026   ED           MOV     A,R5
   \   000027   FB           MOV     R3,A
   \   000028   8014         SJMP    ??afFindEndPointDescList_3
    718              }
    719              else
    720                epSearch = epSearch->nextDesc;  // Next entry
   \                     ??afFindEndPointDescList_2:
   \   00002A   8C82         MOV     DPL,R4
   \   00002C   8D83         MOV     DPH,R5
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   FC           MOV     R4,A
   \   000035   A3           INC     DPTR
   \   000036   E0           MOVX    A,@DPTR
   \   000037   FD           MOV     R5,A
   \   000038   80D6         SJMP    ??afFindEndPointDescList_0
    721            }
    722          
    723            return ( (epList_t *)NULL );
   \                     ??afFindEndPointDescList_1:
   \   00003A   7A00         MOV     R2,#0x0
   \   00003C   7B00         MOV     R3,#0x0
   \                     ??afFindEndPointDescList_3:
   \   00003E   D083         POP     DPH
   \   000040   D082         POP     DPL
   \   000042   02....       LJMP    ?BRET
    724          }
    725          
    726          /*********************************************************************
    727           * @fn      afFindEndPointDesc
    728           *
    729           * @brief   Find the endpoint description entry from the endpoint
    730           *          number.
    731           *
    732           * @param   EndPoint - Application Endpoint to look for
    733           *
    734           * @return  the address to the endpoint/interface description entry
    735           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    736          endPointDesc_t *afFindEndPointDesc( byte EndPoint )
   \                     afFindEndPointDesc:
    737          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
    738            epList_t *epSearch;
    739          
    740            // Look for the endpoint
    741            epSearch = afFindEndPointDescList( EndPoint );
   \   000007                ; Setup parameters for call to function afFindEndPointDescList
   \   000007   A9..         MOV     R1,?V0 + 0
   \   000009   12....       LCALL   ??afFindEndPointDescList?relay
   \   00000C   8A..         MOV     ?V0 + 2,R2
   \   00000E   8B..         MOV     ?V0 + 3,R3
   \   000010   AE..         MOV     R6,?V0 + 2
   \   000012   AF..         MOV     R7,?V0 + 3
    742          
    743            if ( epSearch )
   \   000014   EE           MOV     A,R6
   \   000015   4F           ORL     A,R7
   \   000016   600B         JZ      ??afFindEndPointDesc_0
    744              return ( epSearch->epDesc );
   \   000018   8E82         MOV     DPL,R6
   \   00001A   8F83         MOV     DPH,R7
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   FA           MOV     R2,A
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FB           MOV     R3,A
   \   000021   8004         SJMP    ??afFindEndPointDesc_1
    745            else
    746              return ( (endPointDesc_t *)NULL );
   \                     ??afFindEndPointDesc_0:
   \   000023   7A00         MOV     R2,#0x0
   \   000025   7B00         MOV     R3,#0x0
   \                     ??afFindEndPointDesc_1:
   \   000027   7F04         MOV     R7,#0x4
   \   000029   02....       LJMP    ?BANKED_LEAVE_XDATA
    747          }
    748          
    749          /*********************************************************************
    750           * @fn      afFindSimpleDesc
    751           *
    752           * @brief   Find the Simple Descriptor from the endpoint number.
    753           *
    754           * @param   EP - Application Endpoint to look for.
    755           *
    756           * @return  Non-zero to indicate that the descriptor memory must be freed.
    757           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    758          byte afFindSimpleDesc( SimpleDescriptionFormat_t **ppDesc, byte EP )
   \                     afFindSimpleDesc:
    759          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   89..         MOV     ?V0 + 0,R1
    760            epList_t *epItem = afFindEndPointDescList( EP );
   \   00000B                ; Setup parameters for call to function afFindEndPointDescList
   \   00000B   A9..         MOV     R1,?V0 + 0
   \   00000D   12....       LCALL   ??afFindEndPointDescList?relay
   \   000010   8A..         MOV     ?V0 + 4,R2
   \   000012   8B..         MOV     ?V0 + 5,R3
   \   000014   85....       MOV     ?V0 + 2,?V0 + 4
   \   000017   85....       MOV     ?V0 + 3,?V0 + 5
    761            byte rtrn = FALSE;
   \   00001A   75..00       MOV     ?V0 + 1,#0x0
    762          
    763            if ( epItem )
   \   00001D   E5..         MOV     A,?V0 + 2
   \   00001F   45..         ORL     A,?V0 + 3
   \   000021   6059         JZ      ??afFindSimpleDesc_0
    764            {
    765              if ( epItem->pfnDescCB )
   \   000023   85..82       MOV     DPL,?V0 + 2
   \   000026   85..83       MOV     DPH,?V0 + 3
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F8           MOV     R0,A
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F9           MOV     R1,A
   \   000031   E8           MOV     A,R0
   \   000032   49           ORL     A,R1
   \   000033   6026         JZ      ??afFindSimpleDesc_1
    766              {
    767                *ppDesc = epItem->pfnDescCB( AF_DESCRIPTOR_SIMPLE, EP );
   \   000035                ; Setup parameters for indirect call
   \   000035   AA..         MOV     R2,?V0 + 0
   \   000037   7901         MOV     R1,#0x1
   \   000039   85..82       MOV     DPL,?V0 + 2
   \   00003C   85..83       MOV     DPH,?V0 + 3
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F8           MOV     R0,A
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   F583         MOV     DPH,A
   \   000048   8882         MOV     DPL,R0
   \   00004A   12....       LCALL   ?CALL_IND
   \   00004D   8E82         MOV     DPL,R6
   \   00004F   8F83         MOV     DPH,R7
   \   000051   EA           MOV     A,R2
   \   000052   F0           MOVX    @DPTR,A
   \   000053   A3           INC     DPTR
   \   000054   EB           MOV     A,R3
   \   000055   F0           MOVX    @DPTR,A
    768                rtrn = TRUE;
   \   000056   75..01       MOV     ?V0 + 1,#0x1
   \   000059   802C         SJMP    ??afFindSimpleDesc_2
    769              }
    770              else
    771              {
    772                *ppDesc = epItem->epDesc->simpleDesc;
   \                     ??afFindSimpleDesc_1:
   \   00005B   85..82       MOV     DPL,?V0 + 2
   \   00005E   85..83       MOV     DPH,?V0 + 3
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F8           MOV     R0,A
   \   000063   A3           INC     DPTR
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F583         MOV     DPH,A
   \   000067   8882         MOV     DPL,R0
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   F8           MOV     R0,A
   \   00006E   A3           INC     DPTR
   \   00006F   E0           MOVX    A,@DPTR
   \   000070   F9           MOV     R1,A
   \   000071   8E82         MOV     DPL,R6
   \   000073   8F83         MOV     DPH,R7
   \   000075   E8           MOV     A,R0
   \   000076   F0           MOVX    @DPTR,A
   \   000077   A3           INC     DPTR
   \   000078   E9           MOV     A,R1
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   800B         SJMP    ??afFindSimpleDesc_2
    773              }
    774            }
    775            else
    776            {
    777              *ppDesc = NULL;
   \                     ??afFindSimpleDesc_0:
   \   00007C   8E82         MOV     DPL,R6
   \   00007E   8F83         MOV     DPH,R7
   \   000080   7400         MOV     A,#0x0
   \   000082   F0           MOVX    @DPTR,A
   \   000083   A3           INC     DPTR
   \   000084   7400         MOV     A,#0x0
   \   000086   F0           MOVX    @DPTR,A
    778            }
    779          
    780            return rtrn;
   \                     ??afFindSimpleDesc_2:
   \   000087   A9..         MOV     R1,?V0 + 1
   \   000089   7F06         MOV     R7,#0x6
   \   00008B   02....       LJMP    ?BANKED_LEAVE_XDATA
    781          }
    782          
    783          /*********************************************************************
    784           * @fn      afGetDescCB
    785           *
    786           * @brief   Get the Descriptor callback function.
    787           *
    788           * @param   epDesc - pointer to the endpoint descriptor
    789           *
    790           * @return  function pointer or NULL
    791           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    792          static pDescCB afGetDescCB( endPointDesc_t *epDesc )
   \                     afGetDescCB:
    793          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   EA           MOV     A,R2
   \   000005   F8           MOV     R0,A
   \   000006   EB           MOV     A,R3
   \   000007   F9           MOV     R1,A
    794            epList_t *epSearch;
    795          
    796            // Start at the beginning
    797            epSearch = epList;
   \   000008   90....       MOV     DPTR,#epList
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   FA           MOV     R2,A
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   FB           MOV     R3,A
   \   000010   EA           MOV     A,R2
   \   000011   FC           MOV     R4,A
   \   000012   EB           MOV     A,R3
   \   000013   FD           MOV     R5,A
    798          
    799            // Look through the list until the end
    800            while ( epSearch )
   \                     ??afGetDescCB_0:
   \   000014   EC           MOV     A,R4
   \   000015   4D           ORL     A,R5
   \   000016   6033         JZ      ??afGetDescCB_1
    801            {
    802              // Is there a match?
    803              if ( epSearch->epDesc == epDesc )
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   FA           MOV     R2,A
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FB           MOV     R3,A
   \   000021   E8           MOV     A,R0
   \   000022   6A           XRL     A,R2
   \   000023   7002         JNZ     ??afGetDescCB_2
   \   000025   E9           MOV     A,R1
   \   000026   6B           XRL     A,R3
   \                     ??afGetDescCB_2:
   \   000027   700E         JNZ     ??afGetDescCB_3
    804              {
    805                return ( epSearch->pfnDescCB );
   \   000029   8C82         MOV     DPL,R4
   \   00002B   8D83         MOV     DPH,R5
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   FA           MOV     R2,A
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   FB           MOV     R3,A
   \   000035   8018         SJMP    ??afGetDescCB_4
    806              }
    807              else
    808                epSearch = epSearch->nextDesc;  // Next entry
   \                     ??afGetDescCB_3:
   \   000037   8C82         MOV     DPL,R4
   \   000039   8D83         MOV     DPH,R5
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   FA           MOV     R2,A
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   FB           MOV     R3,A
   \   000045   EA           MOV     A,R2
   \   000046   FC           MOV     R4,A
   \   000047   EB           MOV     A,R3
   \   000048   FD           MOV     R5,A
   \   000049   80C9         SJMP    ??afGetDescCB_0
    809            }
    810          
    811            return ( (pDescCB)NULL );
   \                     ??afGetDescCB_1:
   \   00004B   7A00         MOV     R2,#0x0
   \   00004D   7B00         MOV     R3,#0x0
   \                     ??afGetDescCB_4:
   \   00004F   D083         POP     DPH
   \   000051   D082         POP     DPL
   \   000053   02....       LJMP    ?BRET
    812          }
    813          
    814          /*********************************************************************
    815           * @fn      afDataReqMTU
    816           *
    817           * @brief   Get the Data Request MTU(Max Transport Unit).
    818           *
    819           * @param   fields - afDataReqMTU_t
    820           *
    821           * @return  uint8(MTU)
    822           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    823          uint8 afDataReqMTU( afDataReqMTU_t* fields )
   \                     afDataReqMTU:
    824          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    825            uint8 len;
    826            uint8 hdr;
    827          
    828            if ( fields->kvp == TRUE )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6401         XRL     A,#0x1
   \   000010   7005         JNZ     ??afDataReqMTU_0
    829            {
    830              hdr = AF_HDR_KVP_MAX_LEN;
   \   000012   75..08       MOV     ?V0 + 1,#0x8
   \   000015   8003         SJMP    ??afDataReqMTU_1
    831            }
    832            else
    833            {
    834              hdr = AF_HDR_V1_1_MAX_LEN;
   \                     ??afDataReqMTU_0:
   \   000017   75..00       MOV     ?V0 + 1,#0x0
    835            }
    836          
    837            len = (uint8)(APSDE_DataReqMTU(&fields->aps) - hdr);
   \                     ??afDataReqMTU_1:
   \   00001A                ; Setup parameters for call to function APSDE_DataReqMTU
   \   00001A   8E82         MOV     DPL,R6
   \   00001C   8F83         MOV     DPH,R7
   \   00001E   A3           INC     DPTR
   \   00001F   AA82         MOV     R2,DPL
   \   000021   AB83         MOV     R3,DPH
   \   000023   12....       LCALL   ??APSDE_DataReqMTU?relay
   \   000026   E9           MOV     A,R1
   \   000027   C3           CLR     C
   \   000028   95..         SUBB    A,?V0 + 1
   \   00002A   F5..         MOV     ?V0 + 0,A
    838          
    839            return len;
   \   00002C   A9..         MOV     R1,?V0 + 0
   \   00002E   7F02         MOV     R7,#0x2
   \   000030   02....       LJMP    ?BANKED_LEAVE_XDATA
    840          }
    841          
    842          /*********************************************************************
    843           * @fn      afGetMatch
    844           *
    845           * @brief   Set the allow response flag.
    846           *
    847           * @param   ep - Application Endpoint to look for
    848           * @param   action - true - allow response, false - no response
    849           *
    850           * @return  TRUE allow responses, FALSE no response
    851           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    852          uint8 afGetMatch( uint8 ep )
   \                     afGetMatch:
    853          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
    854            epList_t *epSearch;
    855          
    856            // Look for the endpoint
    857            epSearch = afFindEndPointDescList( ep );
   \   000007                ; Setup parameters for call to function afFindEndPointDescList
   \   000007   A9..         MOV     R1,?V0 + 0
   \   000009   12....       LCALL   ??afFindEndPointDescList?relay
   \   00000C   8A..         MOV     ?V0 + 2,R2
   \   00000E   8B..         MOV     ?V0 + 3,R3
   \   000010   AE..         MOV     R6,?V0 + 2
   \   000012   AF..         MOV     R7,?V0 + 3
    858          
    859            if ( epSearch )
   \   000014   EE           MOV     A,R6
   \   000015   4F           ORL     A,R7
   \   000016   6013         JZ      ??afGetMatch_0
    860            {
    861              if ( epSearch->flags & eEP_AllowMatch )
   \   000018   8E82         MOV     DPL,R6
   \   00001A   8F83         MOV     DPH,R7
   \   00001C   A3           INC     DPTR
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   A2E0         MOV     C,0xE0 /* A   */.0
   \   000021   5004         JNC     ??afGetMatch_1
    862                return ( TRUE );
   \   000023   7901         MOV     R1,#0x1
   \   000025   8006         SJMP    ??afGetMatch_2
    863              else
    864                return ( FALSE );
   \                     ??afGetMatch_1:
   \   000027   7900         MOV     R1,#0x0
   \   000029   8002         SJMP    ??afGetMatch_2
    865            }
    866            else
    867              return ( FALSE );
   \                     ??afGetMatch_0:
   \   00002B   7900         MOV     R1,#0x0
   \                     ??afGetMatch_2:
   \   00002D   7F04         MOV     R7,#0x4
   \   00002F   02....       LJMP    ?BANKED_LEAVE_XDATA
    868          }
    869          
    870          /*********************************************************************
    871           * @fn      afSetMatch
    872           *
    873           * @brief   Set the allow response flag.
    874           *
    875           * @param   ep - Application Endpoint to look for
    876           * @param   action - true - allow response, false - no response
    877           *
    878           * @return  TRUE if success, FALSE if endpoint not found
    879           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    880          uint8 afSetMatch( uint8 ep, uint8 action )
   \                     afSetMatch:
    881          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   8A..         MOV     ?V0 + 1,R2
    882            epList_t *epSearch;
    883          
    884            // Look for the endpoint
    885            epSearch = afFindEndPointDescList( ep );
   \   000009                ; Setup parameters for call to function afFindEndPointDescList
   \   000009   A9..         MOV     R1,?V0 + 0
   \   00000B   12....       LCALL   ??afFindEndPointDescList?relay
   \   00000E   8A..         MOV     ?V0 + 2,R2
   \   000010   8B..         MOV     ?V0 + 3,R3
   \   000012   AE..         MOV     R6,?V0 + 2
   \   000014   AF..         MOV     R7,?V0 + 3
    886          
    887            if ( epSearch )
   \   000016   EE           MOV     A,R6
   \   000017   4F           ORL     A,R7
   \   000018   601E         JZ      ??afSetMatch_0
    888            {
    889              if ( action )
   \   00001A   E5..         MOV     A,?V0 + 1
   \   00001C   600C         JZ      ??afSetMatch_1
    890              {
    891                epSearch->flags |= eEP_AllowMatch;
   \   00001E   8E82         MOV     DPL,R6
   \   000020   8F83         MOV     DPH,R7
   \   000022   A3           INC     DPTR
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   D2E0         SETB    0xE0 /* A   */.0
   \   000027   F0           MOVX    @DPTR,A
   \   000028   800A         SJMP    ??afSetMatch_2
    892              }
    893              else
    894              {
    895                epSearch->flags &= (eEP_AllowMatch ^ 0xFFFF);
   \                     ??afSetMatch_1:
   \   00002A   8E82         MOV     DPL,R6
   \   00002C   8F83         MOV     DPH,R7
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   C2E0         CLR     0xE0 /* A   */.0
   \   000033   F0           MOVX    @DPTR,A
    896              }
    897              return ( TRUE );
   \                     ??afSetMatch_2:
   \   000034   7901         MOV     R1,#0x1
   \   000036   8002         SJMP    ??afSetMatch_3
    898            }
    899            else
    900              return ( FALSE );
   \                     ??afSetMatch_0:
   \   000038   7900         MOV     R1,#0x0
   \                     ??afSetMatch_3:
   \   00003A   7F04         MOV     R7,#0x4
   \   00003C   02....       LJMP    ?BANKED_LEAVE_XDATA
    901          }
    902          
    903          /*********************************************************************
    904           * @fn      afNumEndPoints
    905           *
    906           * @brief   Returns the number of endpoints defined (including 0)
    907           *
    908           * @param   none
    909           *
    910           * @return  number of endpoints
    911           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    912          byte afNumEndPoints( void )
   \                     afNumEndPoints:
    913          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    914            epList_t *epSearch;
    915            byte endpoints;
    916          
    917            // Start at the beginning
    918            epSearch = epList;
   \   000004   90....       MOV     DPTR,#epList
   \   000007   E0           MOVX    A,@DPTR
   \   000008   FC           MOV     R4,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FD           MOV     R5,A
   \   00000C   EC           MOV     A,R4
   \   00000D   FA           MOV     R2,A
   \   00000E   ED           MOV     A,R5
   \   00000F   FB           MOV     R3,A
    919            endpoints = 0;
   \   000010   7900         MOV     R1,#0x0
    920          
    921            while ( epSearch )
   \                     ??afNumEndPoints_0:
   \   000012   EA           MOV     A,R2
   \   000013   4B           ORL     A,R3
   \   000014   6011         JZ      ??afNumEndPoints_1
    922            {
    923              endpoints++;
   \   000016   09           INC     R1
    924              epSearch = epSearch->nextDesc;
   \   000017   8A82         MOV     DPL,R2
   \   000019   8B83         MOV     DPH,R3
   \   00001B   A3           INC     DPTR
   \   00001C   A3           INC     DPTR
   \   00001D   A3           INC     DPTR
   \   00001E   A3           INC     DPTR
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FA           MOV     R2,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FB           MOV     R3,A
   \   000025   80EB         SJMP    ??afNumEndPoints_0
    925            }
    926          
    927            return ( endpoints );
   \                     ??afNumEndPoints_1:
   \   000027   D083         POP     DPH
   \   000029   D082         POP     DPL
   \   00002B   02....       LJMP    ?BRET
    928          }
    929          
    930          /*********************************************************************
    931           * @fn      afEndPoints
    932           *
    933           * @brief   Fills in the passed in buffer with the endpoint (numbers).
    934           *          Use afNumEndPoints to find out how big a buffer to supply.
    935           *
    936           * @param   epBuf - pointer to mem used
    937           *
    938           * @return  void
    939           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    940          void afEndPoints( byte *epBuf, byte skipZDO )
   \                     afEndPoints:
    941          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    942            epList_t *epSearch;
    943            byte endPoint;
    944          
    945            // Start at the beginning
    946            epSearch = epList;
   \   000005   90....       MOV     DPTR,#epList
   \   000008   E0           MOVX    A,@DPTR
   \   000009   FE           MOV     R6,A
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   FF           MOV     R7,A
   \   00000D   EE           MOV     A,R6
   \   00000E   FC           MOV     R4,A
   \   00000F   EF           MOV     A,R7
   \   000010   FD           MOV     R5,A
    947          
    948            while ( epSearch )
   \                     ??afEndPoints_0:
   \   000011   EC           MOV     A,R4
   \   000012   4D           ORL     A,R5
   \   000013   6033         JZ      ??afEndPoints_1
    949            {
    950              endPoint = epSearch->epDesc->endPoint;
   \   000015   8C82         MOV     DPL,R4
   \   000017   8D83         MOV     DPH,R5
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   FE           MOV     R6,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F583         MOV     DPH,A
   \   00001F   8E82         MOV     DPL,R6
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F8           MOV     R0,A
    951          
    952              if ( !skipZDO || endPoint != 0 )
   \   000023   E9           MOV     A,R1
   \   000024   6003         JZ      ??afEndPoints_2
   \   000026   E8           MOV     A,R0
   \   000027   600F         JZ      ??afEndPoints_3
    953                *epBuf++ = endPoint;
   \                     ??afEndPoints_2:
   \   000029   E8           MOV     A,R0
   \   00002A   8A82         MOV     DPL,R2
   \   00002C   8B83         MOV     DPH,R3
   \   00002E   F0           MOVX    @DPTR,A
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   A3           INC     DPTR
   \   000034   AA82         MOV     R2,DPL
   \   000036   AB83         MOV     R3,DPH
    954          
    955              epSearch = epSearch->nextDesc;
   \                     ??afEndPoints_3:
   \   000038   8C82         MOV     DPL,R4
   \   00003A   8D83         MOV     DPH,R5
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   FC           MOV     R4,A
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   FD           MOV     R5,A
   \   000046   80C9         SJMP    ??afEndPoints_0
    956            }
    957          }
   \                     ??afEndPoints_1:
   \   000048   7F01         MOV     R7,#0x1
   \   00004A   02....       LJMP    ?BANKED_LEAVE_XDATA
    958          
    959          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    960          void afCopyAddress ( afAddrType_t *afAddr, zAddrType_t *zAddr )
   \                     afCopyAddress:
    961          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
    962            afAddr->addrMode = (afAddrMode_t)zAddr->addrMode;
   \   00000D   85..82       MOV     DPL,?V0 + 0
   \   000010   85..83       MOV     DPH,?V0 + 1
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   A3           INC     DPTR
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   A3           INC     DPTR
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   8E82         MOV     DPL,R6
   \   00001E   8F83         MOV     DPH,R7
   \   000020   A3           INC     DPTR
   \   000021   A3           INC     DPTR
   \   000022   A3           INC     DPTR
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   F0           MOVX    @DPTR,A
    963            if ( zAddr->addrMode == Addr64Bit )
   \   000029   85..82       MOV     DPL,?V0 + 0
   \   00002C   85..83       MOV     DPH,?V0 + 1
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   A3           INC     DPTR
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   6403         XRL     A,#0x3
   \   00003A   700D         JNZ     ??afCopyAddress_0
    964              osal_cpyExtAddr( afAddr->addr.extAddr, zAddr->addr.extAddr );
   \   00003C                ; Setup parameters for call to function sAddrExtCpy
   \   00003C   AC..         MOV     R4,?V0 + 0
   \   00003E   AD..         MOV     R5,?V0 + 1
   \   000040   EE           MOV     A,R6
   \   000041   FA           MOV     R2,A
   \   000042   EF           MOV     A,R7
   \   000043   FB           MOV     R3,A
   \   000044   12....       LCALL   ??sAddrExtCpy?relay
   \   000047   8014         SJMP    ??afCopyAddress_1
    965            else
    966              afAddr->addr.shortAddr = zAddr->addr.shortAddr;
   \                     ??afCopyAddress_0:
   \   000049   85..82       MOV     DPL,?V0 + 0
   \   00004C   85..83       MOV     DPH,?V0 + 1
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F8           MOV     R0,A
   \   000051   A3           INC     DPTR
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F9           MOV     R1,A
   \   000054   8E82         MOV     DPL,R6
   \   000056   8F83         MOV     DPH,R7
   \   000058   E8           MOV     A,R0
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   E9           MOV     A,R1
   \   00005C   F0           MOVX    @DPTR,A
    967          }
   \                     ??afCopyAddress_1:
   \   00005D   7F02         MOV     R7,#0x2
   \   00005F   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for AF_DataRequestDiscoverRoute>`:
   \   000000   01           DB 1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afRegisterExtended?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afRegisterExtended

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afRegister?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afRegister

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afDataConfirm?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afDataConfirm

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afIncomingData?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afIncomingData

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afBuildMSGIncoming?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afBuildMSGIncoming

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AF_DataRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AF_DataRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AF_DataRequestSrcRtg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AF_DataRequestSrcRtg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afFindEndPointDescList?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afFindEndPointDescList

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afFindEndPointDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afFindEndPointDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afFindSimpleDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afFindSimpleDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afGetDescCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afGetDescCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afDataReqMTU?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afDataReqMTU

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afGetMatch?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afGetMatch

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afSetMatch?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afSetMatch

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afNumEndPoints?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afNumEndPoints

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afEndPoints?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afEndPoints

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??afCopyAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    afCopyAddress
    968          
    969          /*********************************************************************
    970          *********************************************************************/
    971          

   Maximum stack usage in bytes:

   ISTACK PSTACK XSTACK Function
   ------ ------ ------ --------
       1      0     89  AF_DataRequest
                          0 0 56 -> APSDE_DataReq
                          0 0 56 -> NLME_GetShortAddr
                          0 0 56 -> NLME_IsAddressBroadcast
                          0 0 56 -> afDataConfirm
                          0 0 56 -> afDataReqMTU
                          0 0 56 -> afGetDescCB
                          0 0 56 -> osal_mem_free
                          0 0 56 -> sAddrExtCpy
       0      0     45  AF_DataRequestSrcRtg
                          0 0 33 -> AF_DataRequest
                          0 0 24 -> RTG_AddSrcRtgEntry_Guaranteed
       1      0     66  afBuildMSGIncoming
                          0 0 25 -> afCopyAddress
                          0 0 28 -> osal_memcpy
                          0 0 25 -> osal_msg_allocate
                          0 0 25 -> osal_msg_send
       1      0     35  afCopyAddress
                          0 0 10 -> sAddrExtCpy
       1      0     72  afDataConfirm
                          0 0 16 -> afFindEndPointDesc
                          0 0 16 -> osal_msg_allocate
                          0 0 16 -> osal_msg_send
       0      0     66  afDataReqMTU
                          0 0 10 -> APSDE_DataReqMTU
       1      0      9  afEndPoints
       0      0     40  afFindEndPointDesc
                          0 0 12 -> afFindEndPointDescList
       2      0     28  afFindEndPointDescList
       0      0     14  afFindSimpleDesc
                          0 0 14 -> afFindEndPointDescList
       2      0     56  afGetDescCB
       0      0     12  afGetMatch
                          0 0 12 -> afFindEndPointDescList
       0      0     46  afIncomingData
                          0 0 38 -> afBuildMSGIncoming
                          0 0 28 -> afFindEndPointDesc
                          0 0 28 -> afFindEndPointDescList
                          0 0 28 -> aps_FindGroupForEndpoint
                          0 0 28 -> osal_mem_free
       2      0      0  afInit
       2      0      0  afNumEndPoints
       0      0     12  afRegister
                          0 0 12 -> afFindEndPointDescList
                          0 0 12 -> afRegisterExtended
       0      0     28  afRegisterExtended
                          0 0 16 -> osal_mem_alloc
       0      0     12  afSetMatch
                          0 0 12 -> afFindEndPointDescList


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       1  ?<Initializer for AF_DataRequestDiscoverRoute>
       6  ??AF_DataRequest?relay
       6  ??AF_DataRequestSrcRtg?relay
       6  ??afBuildMSGIncoming?relay
       6  ??afCopyAddress?relay
       6  ??afDataConfirm?relay
       6  ??afDataReqMTU?relay
       6  ??afEndPoints?relay
       6  ??afFindEndPointDesc?relay
       6  ??afFindEndPointDescList?relay
       6  ??afFindSimpleDesc?relay
       6  ??afGetDescCB?relay
       6  ??afGetMatch?relay
       6  ??afIncomingData?relay
       6  ??afInit?relay
       6  ??afNumEndPoints?relay
       6  ??afRegister?relay
       6  ??afRegisterExtended?relay
       6  ??afSetMatch?relay
     882  AF_DataRequest
       1  AF_DataRequestDiscoverRoute
     199  AF_DataRequestSrcRtg
     630  afBuildMSGIncoming
      98  afCopyAddress
     121  afDataConfirm
      51  afDataReqMTU
      77  afEndPoints
      44  afFindEndPointDesc
      69  afFindEndPointDescList
     142  afFindSimpleDesc
      86  afGetDescCB
      50  afGetMatch
     664  afIncomingData
      21  afInit
      46  afNumEndPoints
      70  afRegister
     184  afRegisterExtended
      63  afSetMatch
       2  epList

 
 3 497 bytes in segment BANKED_CODE
   108 bytes in segment BANK_RELAYS
     1 byte  in segment XDATA_I
     1 byte  in segment XDATA_ID
     2 bytes in segment XDATA_Z
 
 3 606 bytes of CODE  memory
     3 bytes of XDATA memory

Errors: none
Warnings: none
